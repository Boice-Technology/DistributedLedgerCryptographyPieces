<!DOCTYPE html>
<!-- saved from url=(0069)https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc -->
<html lang="en" class="gr__github_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  <link rel="dns-prefetch" href="https://github.githubassets.com/">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com/">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-lEwNhIgWxFtdGboTlCciWWGiX2vG3LOojEE671oRJEhnPj6jpmgQTJtpq3O2KBzCcln6RzwfvHlyFaI/oR+RNQ==" rel="stylesheet" href="./Transactions_files/frameworks-849637ecbd4bd65815cc113d80fee2d4.css">
  
    <link crossorigin="anonymous" media="all" integrity="sha512-ZIVQ5xH4xRPgEBzl7RRQebsfNJcuNt4tdhboEnRhGSGhyXVESRTxdb9W439oH0MeqADdj5gxaLCLmHYTlOXqtw==" rel="stylesheet" href="./Transactions_files/github-765e7332c1c58bca34b5cadb2351d4d4.css">
    
    
    
    

  <meta name="viewport" content="width=device-width">
  
  <title>bitcoinbook/ch06.asciidoc at develop ¬∑ bitcoinbook/bitcoinbook</title>
    <meta name="description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    <meta name="twitter:image:src" content="https://avatars2.githubusercontent.com/u/5091621?s=400&amp;v=4"><meta name="twitter:site" content="@github"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="bitcoinbook/bitcoinbook"><meta name="twitter:description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">
    <meta property="og:image" content="https://avatars2.githubusercontent.com/u/5091621?s=400&amp;v=4"><meta property="og:site_name" content="GitHub"><meta property="og:type" content="object"><meta property="og:title" content="bitcoinbook/bitcoinbook"><meta property="og:url" content="https://github.com/bitcoinbook/bitcoinbook"><meta property="og:description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">

  <link rel="assets" href="https://github.githubassets.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6NDM2NTUxMzAyOjM0MjExMDAyNzA1M2E4ZGY5Mjk5YWJmZjFlNGMyYzgzMDAzZmZkMTMwZDdiYjdkZDY3ZGJjMTU5NzU2Yjk3NTM=--3d63a60c0558afd65aa2aa5311eb40673c2e20cd">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">
  <meta name="request-id" content="C255:2032:A2A5D:EED9D:5D8F4E9D" data-pjax-transient="">


  

  <meta name="selected-link" value="repo_source" data-pjax-transient="">

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com"><meta name="octolytics-app-id" content="github"><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event"><meta name="octolytics-dimension-request_id" content="C255:2032:A2A5D:EED9D:5D8F4E9D"><meta name="octolytics-dimension-region_edge" content="ap-south-1"><meta name="octolytics-dimension-region_render" content="iad"><meta name="octolytics-dimension-ga_id" content="935325271.1541954184" class="js-octo-ga-id"><meta name="octolytics-dimension-visitor_id" content="21985677137173129"><meta name="octolytics-actor-id" content="39230975"><meta name="octolytics-actor-login" content="DivyPatel9881"><meta name="octolytics-actor-hash" content="333d6a2d3187fb8dfad2488c729f2e3c1a691345037470fab9aa69054014e5ce">
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true">



    <meta name="google-analytics" content="UA-3769691-2">

  <meta class="js-ga-set" name="userId" content="28564a525bddbe7ce98c4bed09794243">

<meta class="js-ga-set" name="dimension1" content="Logged In">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="DivyPatel9881">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="MDQ5OGVkMTY5NmFhNWNjNzhmOWRiZDc3YmM2ZWJiZGIzOWJhM2Q3MDRhYjBiODBhZTQ3YjE5OGRjYThjMTg2OXx7InJlbW90ZV9hZGRyZXNzIjoiMTAzLjE3LjEwMy4yMDciLCJyZXF1ZXN0X2lkIjoiQzI1NToyMDMyOkEyQTVEOkVFRDlEOjVEOEY0RTlEIiwidGltZXN0YW1wIjoxNTY5NjcyODYyLCJob3N0IjoiZ2l0aHViLmNvbSJ9">

    <meta name="enabled-features" content="ACTIONS_V2_ON_MARKETPLACE,MARKETPLACE_FEATURED_BLOG_POSTS,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,MARKETPLACE_PENDING_INSTALLATIONS,NOTIFY_ON_BLOCK,RELATED_ISSUES,GHE_CLOUD_TRIAL">

  <meta name="html-safe-nonce" content="70dee6bc85a4af81b62e97cee1b49327bc2d5f4f">

  <meta http-equiv="x-pjax-version" content="8ae50ecd04a45a3167125c02d6725191">
  

      <link href="https://github.com/bitcoinbook/bitcoinbook/commits/develop.atom" rel="alternate" title="Recent Commits to bitcoinbook:develop" type="application/atom+xml">

  <meta name="go-import" content="github.com/bitcoinbook/bitcoinbook git https://github.com/bitcoinbook/bitcoinbook.git">

  <meta name="octolytics-dimension-user_id" content="5091621"><meta name="octolytics-dimension-user_login" content="bitcoinbook"><meta name="octolytics-dimension-repository_id" content="12044132"><meta name="octolytics-dimension-repository_nwo" content="bitcoinbook/bitcoinbook"><meta name="octolytics-dimension-repository_public" content="true"><meta name="octolytics-dimension-repository_is_fork" content="false"><meta name="octolytics-dimension-repository_network_root_id" content="12044132"><meta name="octolytics-dimension-repository_network_root_nwo" content="bitcoinbook/bitcoinbook"><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false">


    <link rel="canonical" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc" data-pjax-transient="">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://github.githubassets.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  <meta name="webauthn-auth-enabled" content="true">

  <meta name="webauthn-registration-enabled" content="true">

  <link rel="manifest" href="https://github.com/manifest.json" crossorigin="use-credentials">

  </head>

  <body class="logged-in env-production page-responsive page-blob" data-gr-c-s-loaded="true">
    

  <div class="position-relative js-header-wrapper ">
    <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#start-of-content" tabindex="1" class="p-3 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    


          <header class="Header js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">

    <div class="Header-item d-none d-lg-flex">
      <a class="Header-link" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>

    </div>

    <div class="Header-item d-lg-none">
      <button class="Header-link btn-link js-details-target" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 12 16" version="1.1" width="18" aria-hidden="true"><path fill-rule="evenodd" d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"></path></svg>
      </button>
    </div>

    <div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
        <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to" role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox" aria-expanded="false">
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="12044132" data-scoped-search-url="/bitcoinbook/bitcoinbook/search" data-unscoped-search-url="/search" action="https://github.com/bitcoinbook/bitcoinbook/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="‚úì">
      <label class="form-control input-sm header-search-wrapper p-0 header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text" class="form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" data-hotkey="s,/" name="q" value="" placeholder="Search or jump to‚Ä¶" data-unscoped-placeholder="Search or jump to‚Ä¶" data-scoped-placeholder="Search or jump to‚Ä¶" autocapitalize="off" aria-autocomplete="list" aria-controls="jump-to-results" aria-label="Search or jump to‚Ä¶" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=UYEx9QzKW9xZUn6NTxALJRKQBW3CayHQu/+Euoo/rmYwJUNPXcgEJ8nZHZCo8TIFGRx/7fY40PkFaCpvkMDehQ==" spellcheck="false" autocomplete="off">
          <input type="hidden" class="js-site-search-type-field" name="type">
            <img src="./Transactions_files/search-key-slash.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="text-gray">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">‚Üµ</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <img src="./Transactions_files/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
    </li>
</ul>

            </div>
      </label>
</form>  </div>
</div>


      <nav class="d-flex flex-column flex-lg-row flex-self-stretch flex-lg-self-auto" aria-label="Global">
    <a class="Header-link d-block d-lg-none py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" href="https://github.com/dashboard">
      Dashboard
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="https://github.com/pulls">
    Pull requests
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="https://github.com/issues">
    Issues
</a>
    <div class="mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15">
      <a class="js-selected-navigation-item Header-link" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-selected-links=" /marketplace" href="https://github.com/marketplace">
        Marketplace
</a>      

    </div>

  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="https://github.com/explore">
    Explore
</a>


    <a class="Header-link d-block d-lg-none mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" href="https://github.com/DivyPatel9881">
      <img class="avatar" height="20" width="20" alt="@DivyPatel9881" src="./Transactions_files/39230975">
      DivyPatel9881
</a>
    <!-- '"` --><!-- </textarea></xmp> --><form action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="lCMu9wKi8f84y0lo+Kd6dCECXVPIePRAMWh0q29zE/sB61e63J+fTsJ8r+f0tIYaC9svhfDFKwzwOOR4NZ7yfw==">
      <button type="submit" class="Header-link mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15 d-lg-none btn-link d-block width-full text-left" data-ga-click="Header, sign out, icon:logout" style="padding-left: 2px;">
        <svg class="octicon octicon-sign-out v-align-middle" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z"></path></svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative">
      <div class="css-truncate css-truncate-target width-fit position-absolute left-0 right-0 text-center">
              <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
    <a class="Header-link" href="https://github.com/bitcoinbook">bitcoinbook</a>
    /
    <a class="Header-link" href="https://github.com/bitcoinbook/bitcoinbook">bitcoinbook</a>

</div>
    </div>


    <div class="Header-item mr-0 mr-lg-3 flex-order-1 flex-lg-order-none">
      

    <a aria-label="You have no unread notifications" class="Header-link notification-indicator position-relative tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-hotkey="g n" data-ga-click="Header, go to notifications, icon:read" data-channel="notification-changed:39230975" href="https://github.com/notifications">
        <span class="mail-status "></span>
        <svg class="octicon octicon-bell" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
    </div>


    <div class="Header-item position-relative d-none d-lg-flex">
      <details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="Create new‚Ä¶" data-ga-click="Header, create new, icon:add" aria-haspopup="menu" role="button">
    <svg class="octicon octicon-plus" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"></path></svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw" role="menu">
    
<a role="menuitem" class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>


  <div role="none" class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="bitcoinbook/bitcoinbook">This repository</span>
  </div>
    <a role="menuitem" class="dropdown-item" href="https://github.com/bitcoinbook/bitcoinbook/issues/new" data-ga-click="Header, create new issue" data-skip-pjax="">
      New issue
    </a>


  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-lg-flex">
      
<details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar" aria-haspopup="menu" role="button">
    <img alt="@DivyPatel9881" class="avatar" src="./Transactions_files/39230975(1)" height="20" width="20">
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw mt-2" style="width: 180px" role="menu">
    <div class="header-nav-current-user css-truncate"><a role="menuitem" class="no-underline user-profile-link px-3 pt-2 pb-2 mb-n2 mt-n1 d-block" href="https://github.com/DivyPatel9881" data-ga-click="Header, go to profile, text:Signed in as">Signed in as <strong class="css-truncate-target">DivyPatel9881</strong></a></div>
    <div role="none" class="dropdown-divider"></div>

      <div class="pl-3 pr-3 f6 user-status-container js-user-status-context pb-1" data-url="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1">
        
<div class="js-user-status-container
    user-status-compact rounded-1 px-2 py-1 mt-2
    border
  " data-team-hovercards-enabled="">
  <details class="js-user-status-details details-reset details-overlay details-overlay-dark">
    <summary class="btn-link btn-block link-gray no-underline js-toggle-user-status-edit toggle-user-status-edit " role="menuitem" data-hydro-click="{&quot;event_type&quot;:&quot;user_profile.click&quot;,&quot;payload&quot;:{&quot;profile_user_id&quot;:5091621,&quot;target&quot;:&quot;EDIT_USER_STATUS&quot;,&quot;user_id&quot;:39230975,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C255:2032:A2A5D:EED9D:5D8F4E9D&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;}}" data-hydro-click-hmac="df33c43766bdbd93c45c3ab34449d6feeab893c3bd088585e039bbcadd743164">
      <div class="d-flex">
        <div class="f6 lh-condensed user-status-header
          d-inline-block v-align-middle
            user-status-emoji-only-header circle
            pr-2
" style="max-width: 29px">
          <div class="user-status-emoji-container flex-shrink-0 mr-1 mt-1 lh-condensed-ultra v-align-bottom" style="">
            <g-emoji alias="thought_balloon" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4ad.png">üí≠</g-emoji>
          </div>
        </div>
        <div class="
          d-inline-block v-align-middle
          
          
           css-truncate css-truncate-target 
           user-status-message-wrapper f6" style="line-height: 20px;">
          <div class="d-inline-block text-gray-dark v-align-text-top text-left">
                <span>I can !!!!!</span>
          </div>
        </div>
      </div>
    </summary>
    <details-dialog class="details-dialog rounded-1 anim-fade-in fast Box Box--overlay" role="dialog" tabindex="-1" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="position-relative flex-auto js-user-status-form" action="https://github.com/users/status?compact=1&amp;link_mentions=0&amp;truncate=1" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="_method" value="put"><input type="hidden" name="authenticity_token" value="1oTZhiEG+cmXWWPYir6o1oy9+XMSK+KpBDve7paygWXAzxzCu1lX7ITTUP1n2ck2xrKKchiqUMVl6TES+4UI+w==">
        <div class="Box-header bg-gray border-bottom p-3">
          <button class="Box-btn-octicon js-toggle-user-status-edit btn-octicon float-right" type="reset" aria-label="Close dialog" data-close-dialog="">
            <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
          </button>
          <h3 class="Box-title f5 text-bold text-gray-dark">Edit status</h3>
        </div>
        <input type="hidden" name="emoji" class="js-user-status-emoji-field" value="">
        <input type="hidden" name="organization_id" class="js-user-status-org-id-field" value="">
        <div class="px-3 py-2 text-gray-dark">
          <div class="js-characters-remaining-container position-relative mt-2">
            <div class="input-group d-table form-group my-0 js-user-status-form-group">
              <span class="input-group-button d-table-cell v-align-middle" style="width: 1%">
                <button type="button" aria-label="Choose an emoji" class="btn-outline btn js-toggle-user-status-emoji-picker btn-open-emoji-picker p-0">
                  <span class="js-user-status-original-emoji" hidden=""></span>
                  <span class="js-user-status-custom-emoji"></span>
                  <span class="js-user-status-no-emoji-icon">
                    <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
                  </span>
                </button>
              </span>
              <text-expander keys=": @" data-mention-url="/autocomplete/user-suggestions" data-emoji-url="/autocomplete/emoji">
                <input type="text" autocomplete="off" data-no-org-url="/autocomplete/user-suggestions" data-org-url="/suggestions?mention_suggester=1" data-maxlength="80" class="d-table-cell width-full form-control js-user-status-message-field js-characters-remaining-field" placeholder="What&#39;s happening?" name="message" value="I can !!!!!" aria-label="What is your current status?">
              </text-expander>
              <div class="error">Could not update your status, please try again.</div>
            </div>
            <div style="margin-left: 53px" class="my-1 text-small label-characters-remaining js-characters-remaining" data-suffix="remaining" hidden="">
              80 remaining
            </div>
          </div>
          <include-fragment class="js-user-status-emoji-picker" data-url="/users/status/emoji"></include-fragment>
          <div class="overflow-auto ml-n3 mr-n3 px-3 border-bottom" style="max-height: 33vh">
            <div class="user-status-suggestions js-user-status-suggestions collapsed overflow-hidden">
              <h4 class="f6 text-normal my-3">Suggestions:</h4>
              <div class="mx-3 mt-2 clearfix">
                  <div class="float-left col-6">
                      <button type="button" value=":palm_tree:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="palm_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f334.png">üå¥</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          On vacation
                        </div>
                      </button>
                      <button type="button" value=":face_with_thermometer:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="face_with_thermometer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f912.png">ü§í</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Out sick
                        </div>
                      </button>
                  </div>
                  <div class="float-left col-6">
                      <button type="button" value=":house:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="house" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e0.png">üè†</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Working from home
                        </div>
                      </button>
                      <button type="button" value=":dart:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="dart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3af.png">üéØ</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Focusing
                        </div>
                      </button>
                  </div>
              </div>
            </div>
            <div class="user-status-limited-availability-container">
              <div class="form-checkbox my-0">
                <input type="checkbox" name="limited_availability" value="1" class="js-user-status-limited-availability-checkbox" data-default-message="I may be slow to respond." aria-describedby="limited-availability-help-text-truncate-true-compact-true" id="limited-availability-truncate-true-compact-true">
                <label class="d-block f5 text-gray-dark mb-1" for="limited-availability-truncate-true-compact-true">
                  Busy
                </label>
                <p class="note" id="limited-availability-help-text-truncate-true-compact-true">
                  When others mention you, assign you, or request your review,
                  GitHub will let them know that you have limited availability.
                </p>
              </div>
            </div>
          </div>
            

<div class="d-inline-block f5 mr-2 pt-3 pb-2">
  <div class="d-inline-block mr-1">
    Clear status
  </div>

  <details class="js-user-status-expire-drop-down f6 dropdown details-reset details-overlay d-inline-block mr-2">
    <summary class="f5 btn-link link-gray-dark border px-2 py-1 rounded-1" aria-haspopup="true">
      <div class="js-user-status-expiration-interval-selected d-inline-block v-align-baseline">
        Never
      </div>
      <div class="dropdown-caret"></div>
    </summary>

    <ul class="dropdown-menu dropdown-menu-se pl-0 overflow-auto" style="width: 220px; max-height: 15.5em">
      <li>
        <button type="button" class="btn-link dropdown-item js-user-status-expire-button ws-normal" title="Never">
          <span class="d-inline-block text-bold mb-1">Never</span>
          <div class="f6 lh-condensed">Keep this status until you clear your status or edit your status.</div>
        </button>
      </li>
      <li class="dropdown-divider" role="none"></li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 30 minutes" value="2019-09-28T18:14:22+05:30">
            in 30 minutes
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 1 hour" value="2019-09-28T18:44:22+05:30">
            in 1 hour
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 4 hours" value="2019-09-28T21:44:22+05:30">
            in 4 hours
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="today" value="2019-09-28T23:59:59+05:30">
            today
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="this week" value="2019-09-29T23:59:59+05:30">
            this week
          </button>
        </li>
    </ul>
  </details>
  <input class="js-user-status-expiration-date-input" type="hidden" name="expires_at" value="">
</div>

          <include-fragment class="js-user-status-org-picker" data-url="/users/status/organizations"></include-fragment>
        </div>
        <div class="d-flex flex-items-center flex-justify-between p-3 border-top">
          <button type="submit" class="width-full btn btn-primary mr-2 js-user-status-submit">
            Set status
          </button>
          <button type="button" class="width-full js-clear-user-status-button btn ml-2 js-user-status-exists">
            Clear status
          </button>
        </div>
</form>    </details-dialog>
  </details>
</div>

      </div>
      <div role="none" class="dropdown-divider"></div>


    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881" data-ga-click="Header, go to profile, text:your profile">Your profile</a>


    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=repositories" data-ga-click="Header, go to repositories, text:your repositories">Your repositories</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=projects" data-ga-click="Header, go to projects, text:your projects">Your projects</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">Your stars</a>
      <a role="menuitem" class="dropdown-item" href="https://gist.github.com/mine" data-ga-click="Header, your gists, text:your gists">Your gists</a>


    <div role="none" class="dropdown-divider"></div>
    <a role="menuitem" class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">Help</a>
    <a role="menuitem" class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">Settings</a>
    <!-- '"` --><!-- </textarea></xmp> --><form class="logout-form" action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="gxUTbXNk3Bu64cxSiAM9FLO/tg5Ihz39odQyxj2BHIUW3WogrVmyqkBWKt2EEMF6mWbE2HA64rFghKIVZ2z9AQ==">
      
      <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout" role="menuitem">
        Sign out
      </button>
</form>  </details-menu>
</details>

    </div>

  </header>

      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>


    <div id="js-flash-container">

</div>



  <div class="application-main " data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main>
      


  



  








  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
    <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">

      <ul class="pagehead-actions">




  <li>
    
    <!-- '"` --><!-- </textarea></xmp> --><form data-remote="true" class="clearfix js-social-form js-social-container" action="https://github.com/notifications/subscribe" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="qPNlj4tljP4vBxsRAZPnldnJ3b4k61ebC9e0VF/KyqqEG2QG+ilCHclbbErULcorQIVbifdXo12adE7TdSI7Ng==">      <input type="hidden" name="repository_id" value="12044132">

      <details class="details-reset details-overlay select-menu float-left">
        <summary class="select-menu-button float-left btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;WATCH_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C255:2032:A2A5D:EED9D:5D8F4E9D&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="cad81c50ef5e16ad87fe69485da8f57ad2862445a333917034c519fbe52ffd4f" data-ga-click="Repository, click Watch settings, action:blob#show" aria-haspopup="menu" role="button">          <span data-menu-button="">
              <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
              Watch
          </span>
</summary>        <details-menu class="select-menu-modal position-absolute mt-5" style="z-index: 99;" role="menu">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
          </div>
          <div class="select-menu-list">
            <button type="submit" name="do" value="included" class="select-menu-item width-full" aria-checked="true" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Not watching</span>
                <span class="description">Be notified only when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Watch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="release_only" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Releases only</span>
                <span class="description">Be notified of new releases, and when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch releases
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="subscribed" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Watching</span>
                <span class="description">Be notified of all conversations.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="ignore" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Ignoring</span>
                <span class="description">Never be notified.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-mute v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                  Stop ignoring
                </span>
              </div>
            </button>
          </div>
        </details-menu>
      </details>
        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/watchers" aria-label="992 users are watching this repository">
          992
        </a>
</form>
  </li>

  <li>
      <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --><form class="starred js-social-form" action="https://github.com/bitcoinbook/bitcoinbook/unstar" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="1VXYArDq+r9jQGKAQlMqeablTY6AjLowhWcstc/AP41qWOAhWclnBhGC5uJkImPhkqvbh0WjlPu3qrqS6DsSPw==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar bitcoinbook/bitcoinbook" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C255:2032:A2A5D:EED9D:5D8F4E9D&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="7610433bc714b936b8182143c5f8a92a8d6a7df0f7410db4f0a308d069d48448" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Unstar
</button>        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/stargazers" aria-label="12336 users starred this repository">
           12,336
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --><form class="unstarred js-social-form" action="https://github.com/bitcoinbook/bitcoinbook/star" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="7J+sFPcBmkLTkRnM4BTTCvodK/0vdp9jHyT1gah+3R3otCte1tljJ1kQ+y1lVTLxGJaG1lFW06AuPdTFzdMzNQ==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Star bitcoinbook/bitcoinbook" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C255:2032:A2A5D:EED9D:5D8F4E9D&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="c179d2e64058b81a89c53d05be804d0adeb513f22e58e89b18d70e84a614d8aa" data-ga-click="Repository, click star button, action:blob#show; text:Star">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Star
</button>        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/stargazers" aria-label="12336 users starred this repository">
          12,336
        </a>
</form>  </div>

  </li>

  <li>
          <details class="details-reset details-overlay details-overlay-dark d-inline-block float-left">
            <summary class="btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C255:2032:A2A5D:EED9D:5D8F4E9D&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="513aacd41509db363317fa078cce69f6297bd0a04ad880888d506a44ee14e59c" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" title="Fork your own copy of bitcoinbook/bitcoinbook to your account" role="button">              <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
              Fork
</summary>            <details-dialog class="anim-fade-in fast Box Box--overlay d-flex flex-column" src="/bitcoinbook/bitcoinbook/fork?fragment=1" preload="" role="dialog" aria-modal="true">
              <div class="Box-header">
                <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
                  <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
                </button>
                <h3 class="Box-title">Fork bitcoinbook</h3>
              </div>
              <div class="overflow-auto text-center">
                <include-fragment>
                  <div class="octocat-spinner my-3" aria-label="Loading..."></div>
                  <p class="f5 text-gray">If this dialog fails to load, you can visit <a href="https://github.com/bitcoinbook/bitcoinbook/fork">the fork page</a> directly.</p>
                </include-fragment>
              </div>
            </details-dialog>
          </details>

    <a href="https://github.com/bitcoinbook/bitcoinbook/network/members" class="social-count" aria-label="3585 users forked this repository">
      3,585
    </a>
  </li>
</ul>

      <h1 class="public ">
    <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" data-hovercard-type="organization" data-hovercard-url="/orgs/bitcoinbook/hovercard" href="https://github.com/bitcoinbook">bitcoinbook</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="https://github.com/bitcoinbook/bitcoinbook">bitcoinbook</a></strong>
  

</h1>

    </div>
    
<nav class="hx_reponav reponav js-repo-nav js-sidenav-container-pjax container-lg p-responsive d-none d-lg-block" itemscope="" itemtype="http://schema.org/BreadcrumbList" aria-label="Repository" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /bitcoinbook/bitcoinbook" href="https://github.com/bitcoinbook/bitcoinbook">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /bitcoinbook/bitcoinbook/issues" href="https://github.com/bitcoinbook/bitcoinbook/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">66</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /bitcoinbook/bitcoinbook/pulls" href="https://github.com/bitcoinbook/bitcoinbook/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">24</span>
      <meta itemprop="position" content="3">
</a>  </span>


    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /bitcoinbook/bitcoinbook/projects" href="https://github.com/bitcoinbook/bitcoinbook/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      Projects
      <span class="Counter">0</span>
</a>


    <a data-skip-pjax="true" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /bitcoinbook/bitcoinbook/security/advisories" href="https://github.com/bitcoinbook/bitcoinbook/security/advisories">
      <svg class="octicon octicon-shield" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 2l7-2 7 2v6.02C14 12.69 8.69 16 7 16c-1.69 0-7-3.31-7-7.98V2zm1 .75L7 1l6 1.75v5.268C13 12.104 8.449 15 7 15c-1.449 0-6-2.896-6-6.982V2.75zm1 .75L7 2v12c-1.207 0-5-2.482-5-5.985V3.5z"></path></svg>
      Security
</a>
    <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse people /bitcoinbook/bitcoinbook/pulse" href="https://github.com/bitcoinbook/bitcoinbook/pulse">
      <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
      Insights
</a>

</nav>

  <div class="reponav-wrapper reponav-small d-lg-none">
  <nav class="reponav js-reponav text-center no-wrap" itemscope="" itemtype="http://schema.org/BreadcrumbList">

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a class="js-selected-navigation-item selected reponav-item" itemprop="url" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /bitcoinbook/bitcoinbook" href="https://github.com/bitcoinbook/bitcoinbook">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /bitcoinbook/bitcoinbook/issues" href="https://github.com/bitcoinbook/bitcoinbook/issues">
          <span itemprop="name">Issues</span>
          <span class="Counter">66</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /bitcoinbook/bitcoinbook/pulls" href="https://github.com/bitcoinbook/bitcoinbook/pulls">
        <span itemprop="name">Pull requests</span>
        <span class="Counter">24</span>
        <meta itemprop="position" content="3">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /bitcoinbook/bitcoinbook/projects" href="https://github.com/bitcoinbook/bitcoinbook/projects">
          <span itemprop="name">Projects</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="4">
</a>      </span>


      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /bitcoinbook/bitcoinbook/security/advisories" href="https://github.com/bitcoinbook/bitcoinbook/security/advisories">
        <span itemprop="name">Security</span>
        <meta itemprop="position" content="6">
</a>
      <a class="js-selected-navigation-item reponav-item" data-selected-links="pulse /bitcoinbook/bitcoinbook/pulse" href="https://github.com/bitcoinbook/bitcoinbook/pulse">
        Pulse
</a>
      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="community /bitcoinbook/bitcoinbook/community" href="https://github.com/bitcoinbook/bitcoinbook/community">
          Community
</a>      </span>

  </nav>
</div>


  </div>
<div class="container-lg clearfix new-discussion-timeline experiment-repo-nav  p-responsive">
  <div class="repository-content ">

    
    


  


    <a class="d-none js-permalink-shortcut" data-hotkey="y" href="https://github.com/bitcoinbook/bitcoinbook/blob/38e5bd84a6b15025bc84be9073f717db9bb81ee9/ch06.asciidoc">Permalink</a>

    <!-- blob contrib key: blob_contributors:v21:58f0922521cd06bc38ddc344a40a5c18 -->
      

    <div class="d-flex flex-items-start flex-shrink-0 pb-3 flex-column flex-md-row">
      <span class="d-flex flex-justify-between width-full width-md-auto">
        
<details class="details-reset details-overlay select-menu branch-select-menu  hx_rsm" id="branch-select-menu">
  <summary class="btn btn-sm select-menu-button css-truncate" data-hotkey="w" title="Switch branches or tags" aria-haspopup="menu" role="button">
    <i>Branch:</i>
    <span class="css-truncate-target" data-menu-button="">develop</span>
  </summary>

  <details-menu class="select-menu-modal hx_rsm-modal position-absolute" style="z-index: 99;" src="/bitcoinbook/bitcoinbook/ref-list/develop/ch06.asciidoc?source_action=show&amp;source_controller=blob" preload="" role="menu">
    <include-fragment class="select-menu-loading-overlay anim-pulse">
      <svg height="32" class="octicon octicon-octoface" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M14.7 5.34c.13-.32.55-1.59-.13-3.31 0 0-1.05-.33-3.44 1.3-1-.28-2.07-.32-3.13-.32s-2.13.04-3.13.32c-2.39-1.64-3.44-1.3-3.44-1.3-.68 1.72-.26 2.99-.13 3.31C.49 6.21 0 7.33 0 8.69 0 13.84 3.33 15 7.98 15S16 13.84 16 8.69c0-1.36-.49-2.48-1.3-3.35zM8 14.02c-3.3 0-5.98-.15-5.98-3.35 0-.76.38-1.48 1.02-2.07 1.07-.98 2.9-.46 4.96-.46 2.07 0 3.88-.52 4.96.46.65.59 1.02 1.3 1.02 2.07 0 3.19-2.68 3.35-5.98 3.35zM5.49 9.01c-.66 0-1.2.8-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.54-1.78-1.2-1.78zm5.02 0c-.66 0-1.2.79-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.53-1.78-1.2-1.78z"></path></svg>
    </include-fragment>
  </details-menu>
</details>

        <div class="BtnGroup flex-shrink-0 d-md-none">
          <a href="https://github.com/bitcoinbook/bitcoinbook/find/develop" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
            Find file
          </a>
          <clipboard-copy value="ch06.asciidoc" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
            Copy path
          </clipboard-copy>
        </div>
      </span>
      <h2 id="blob-path" class="breadcrumb flex-auto min-width-0 text-normal flex-md-self-center ml-md-2 mr-md-3 my-2 my-md-0">
        <span class="js-repo-root text-bold"><span class="js-path-segment"><a data-pjax="true" href="https://github.com/bitcoinbook/bitcoinbook"><span>bitcoinbook</span></a></span></span><span class="separator">/</span><strong class="final-path">ch06.asciidoc</strong>
      </h2>

      <div class="BtnGroup flex-shrink-0 d-none d-md-inline-block">
        <a href="https://github.com/bitcoinbook/bitcoinbook/find/develop" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
          Find file
        </a>
        <clipboard-copy value="ch06.asciidoc" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
          Copy path
        </clipboard-copy>
      </div>
    </div>



    
  <div class="Box Box--condensed d-flex flex-column flex-shrink-0">
      <div class="Box-body d-flex flex-justify-between bg-blue-light flex-column flex-md-row flex-items-start flex-md-items-center">
        <span class="pr-md-4 f6">
          <a rel="contributor" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/wbnns"><img class="avatar" src="./Transactions_files/1130872" width="20" height="20" alt="@wbnns"></a>
          <a class="text-bold link-gray-dark lh-default v-align-middle" rel="contributor" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/wbnns">wbnns</a>
            <span class="lh-default v-align-middle">
              <a data-pjax="true" title="Merge pull request #588 from hebasto/ch06-grammatical-number

ch06 - fixed grammatical number" class="link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/ef278c6fe20f2f49bdb6467c616a1fca8ba839fc">Merge pull request</a> <a class="issue-link js-issue-link" data-error-text="Failed to load issue title" data-id="343431680" data-permission-text="Issue title is private" data-url="https://github.com/bitcoinbook/bitcoinbook/issues/588" data-hovercard-type="pull_request" data-hovercard-url="/bitcoinbook/bitcoinbook/pull/588/hovercard" href="https://github.com/bitcoinbook/bitcoinbook/pull/588">#588</a> <a data-pjax="true" title="Merge pull request #588 from hebasto/ch06-grammatical-number

ch06 - fixed grammatical number" class="link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/ef278c6fe20f2f49bdb6467c616a1fca8ba839fc">from hebasto/ch06-grammatical-number</a>
            </span>
        </span>
        <span class="d-inline-block flex-shrink-0 v-align-bottom f6 mt-2 mt-md-0">
          <a class="pr-2 text-mono link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/ef278c6fe20f2f49bdb6467c616a1fca8ba839fc" data-pjax="">ef278c6</a>
          <relative-time datetime="2019-06-19T21:14:09Z" title="Jun 20, 2019, 2:44 AM GMT+5:30">on Jun 20</relative-time>
        </span>
      </div>

    <div class="Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap">
      <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
        <summary class="btn-link" role="button">
          <span><strong>23</strong> contributors</span>
        </summary>
        <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast" aria-label="Users who have contributed to this file" src="/bitcoinbook/bitcoinbook/contributors/develop/ch06.asciidoc/list" preload="" role="dialog" aria-modal="true">
          <div class="Box-header">
            <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
              <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
            </button>
            <h3 class="Box-title">
              Users who have contributed to this file
            </h3>
          </div>
          <include-fragment class="octocat-spinner my-3" aria-label="Loading..."></include-fragment>
        </details-dialog>
      </details>
        <span class="">
    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1181915" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=aantonop">
      <img class="avatar mr-1" src="./Transactions_files/1181915" width="20" height="20" alt="@aantonop"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=5178634" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=IndexPro">
      <img class="avatar mr-1" src="./Transactions_files/5178634" width="20" height="20" alt="@IndexPro"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=13317719" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=nadamsoreilly">
      <img class="avatar mr-1" src="./Transactions_files/13317719" width="20" height="20" alt="@nadamsoreilly"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1180731" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=myarbrough">
      <img class="avatar mr-1" src="./Transactions_files/1180731" width="20" height="20" alt="@myarbrough"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=598132" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=enderminh">
      <img class="avatar mr-1" src="./Transactions_files/598132" width="20" height="20" alt="@enderminh"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=wbnns">
      <img class="avatar mr-1" src="./Transactions_files/1130872" width="20" height="20" alt="@wbnns"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=7134319" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=hackermatthew">
      <img class="avatar mr-1" src="./Transactions_files/7134319" width="20" height="20" alt="@hackermatthew"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=8242469" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=edeykholt">
      <img class="avatar mr-1" src="./Transactions_files/8242469" width="20" height="20" alt="@edeykholt"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=2844363" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=yurigeorgiev4">
      <img class="avatar mr-1" src="./Transactions_files/2844363" width="20" height="20" alt="@yurigeorgiev4"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=26572234" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=jachiang">
      <img class="avatar mr-1" src="./Transactions_files/26572234" width="20" height="20" alt="@jachiang"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=2633903" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=mjones-wordco">
      <img class="avatar mr-1" src="./Transactions_files/2633903" width="20" height="20" alt="@mjones-wordco"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=402492" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=Yky">
      <img class="avatar mr-1" src="./Transactions_files/402492" width="20" height="20" alt="@Yky"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1178372" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=kristenORM">
      <img class="avatar mr-1" src="./Transactions_files/1178372" width="20" height="20" alt="@kristenORM"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=3603681" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=zduniak">
      <img class="avatar mr-1" src="./Transactions_files/3603681" width="20" height="20" alt="@zduniak"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=17382" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=rrthomas">
      <img class="avatar mr-1" src="./Transactions_files/17382" width="20" height="20" alt="@rrthomas"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=25371667" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=Rfurse">
      <img class="avatar mr-1" src="./Transactions_files/25371667" width="20" height="20" alt="@Rfurse"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=25386049" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=oboukli">
      <img class="avatar mr-1" src="./Transactions_files/25386049" width="20" height="20" alt="@oboukli"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=3900799" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=kargakis">
      <img class="avatar mr-1" src="./Transactions_files/3900799" width="20" height="20" alt="@kargakis"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1709528" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=Lornestar">
      <img class="avatar mr-1" src="./Transactions_files/1709528" width="20" height="20" alt="@Lornestar"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=7402694" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=erikwam">
      <img class="avatar mr-1" src="./Transactions_files/7402694" width="20" height="20" alt="@erikwam"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=2109420" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=ALeschinsky">
      <img class="avatar mr-1" src="./Transactions_files/2109420" width="20" height="20" alt="@ALeschinsky"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=5015637" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=allymacdonald">
      <img class="avatar mr-1" src="./Transactions_files/5015637" width="20" height="20" alt="@allymacdonald"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=32963518" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc?author=hebasto">
      <img class="avatar mr-1" src="./Transactions_files/32963518" width="20" height="20" alt="@hebasto"> 
</a>
</span>

    </div>
  </div>





    <div class="Box mt-3 position-relative">
      
<div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">

  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
      735 lines (497 sloc)
      <span class="file-info-divider"></span>
    69.2 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="https://github.com/bitcoinbook/bitcoinbook/raw/develop/ch06.asciidoc">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="https://github.com/bitcoinbook/bitcoinbook/blame/develop/ch06.asciidoc">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch06.asciidoc">History</a>
    </div>


    <div>
            <a class="btn-octicon tooltipped tooltipped-nw hide-sm" href="x-github-client://openRepo/https://github.com/bitcoinbook/bitcoinbook?branch=develop&amp;filepath=ch06.asciidoc" aria-label="Open this file in GitHub Desktop" data-ga-click="Repository, open with desktop, type:windows">
                <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"></path></svg>
            </a>

            <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form js-update-url-with-hash" action="https://github.com/bitcoinbook/bitcoinbook/edit/develop/ch06.asciidoc" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="idCv60iBGLRIH8S5Iu4HrU83D4+91H/pGcRwMGoZLXChQLCeD0PCuw8kdHCekRWsR+ZdWG4YX/yylZZkyg6etw==">
              <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
                <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
              </button>
</form>
          <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form" action="https://github.com/bitcoinbook/bitcoinbook/delete/develop/ch06.asciidoc" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="‚úì"><input type="hidden" name="authenticity_token" value="efweDsZohCF6X0aM4Kq2n2NiDSna1IptG742ONpzZerpXqacK2q3I+Fd0TLSwGD4psKAq2fHUH1zj80kwrZOUA==">
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
              <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
            </button>
</form>    </div>
  </div>
</div>




      
  <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
    <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><div>
<h2 id="user-content-transactions"><a id="user-content-transactions" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transactions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transactions</h2>
<div>
<div>
<h3 id="user-content-ch06_intro"><a id="user-content-introduction" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#introduction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<div>
<p>Transactions are the most important part of the bitcoin system. Everything else in bitcoin is designed to ensure that transactions can be created, propagated on the network, validated, and finally added to the global ledger of transactions (the blockchain). Transactions are data structures that encode the transfer of value between participants in the bitcoin system. Each transaction is a public entry in bitcoin‚Äôs blockchain, the global double-entry bookkeeping ledger.</p>
</div>
<div>
<p>In this chapter we will examine all the various forms of transactions, what they contain, how to create them, how they are verified, and how they become part of the permanent record of all transactions. When we use the term "wallet" in this chapter, we are referring to the software that constructs transactions, not just the database of keys.</p>
</div>
</div>
<div>
<h3 id="user-content-tx_structure"><a id="user-content-transactions-in-detail" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transactions-in-detail"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transactions in Detail</h3>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#ch02_bitcoin_overview">[ch02_bitcoin_overview]</a>, we looked at the transaction Alice used to pay for coffee at Bob‚Äôs coffee shop using a block explorer (<a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#alices_transactions_to_bobs_cafe">Alice‚Äôs transaction to Bob‚Äôs Cafe</a>).</p>
</div>
<div>
<p>The block explorer application shows a transaction from Alice‚Äôs "address" to Bob‚Äôs "address." This is a much simplified view of what is contained in a transaction. In fact, as we will see in this chapter, much of the information shown is constructed by the block explorer and is not actually in the transaction.</p>
</div>
<div id="user-content-alices_transactions_to_bobs_cafe">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0208.png"><img src="./Transactions_files/mbc2_0208.png" alt="Alice Coffee Transaction" style="max-width:100%;"></a>
</div>
<div>Figure 1. Alice‚Äôs transaction to Bob‚Äôs Cafe</div>
</div>
<div>
<h4 id="user-content-transactions_behind_the_scenes"><a id="user-content-transactionsbehind-the-scenes" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transactionsbehind-the-scenes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transactions‚ÄîBehind the Scenes</h4>
<div>
<p>Behind the scenes, an actual transaction looks very different from a transaction provided by a typical block explorer. In fact, most of the high-level constructs we see in the various bitcoin application user interfaces <em>do not actually exist</em> in the bitcoin system.</p>
</div>
<div>
<p>We can use Bitcoin Core‚Äôs command-line interface (getrawtransaction and decoderawtransaction) to retrieve Alice‚Äôs "raw" transaction, decode it, and see what it contains. The result looks like this:</p>
</div>
<div id="user-content-alice_tx">
<div>Alice‚Äôs transaction decoded</div>
<div>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
  <span class="pl-s"><span class="pl-pds">"</span>locktime<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
  <span class="pl-s"><span class="pl-pds">"</span>vin<span class="pl-pds">"</span></span>: [
    {
      <span class="pl-s"><span class="pl-pds">"</span>txid<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
      <span class="pl-s"><span class="pl-pds">"</span>scriptSig<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>sequence<span class="pl-pds">"</span></span>: <span class="pl-c1">4294967295</span>
    }
  ],
  <span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: [
    {
      <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">0.01500000</span>,
      <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY OP_CHECKSIG<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">0.08450000</span>,
      <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG<span class="pl-pds">"</span></span>,
    }
  ]
}</pre></div>
</div>
</div>
<div>
<p>You may notice a few things about this transaction, mostly the things that are missing! Where is Alice‚Äôs address? Where is Bob‚Äôs address? Where is the 0.1 input "sent" by Alice? In bitcoin, there are no coins, no senders, no recipients, no balances, no accounts, and no addresses. All those things are constructed at a higher level for the benefit of the user, to make things easier to understand.</p>
</div>
<div>
<p>You may also notice a lot of strange and indecipherable fields and hexadecimal strings. Don‚Äôt worry, we will explain each field shown here in detail in this chapter.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-tx_inputs_outputs"><a id="user-content-transaction-outputs-and-inputs" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-outputs-and-inputs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Outputs and Inputs</h3>
<div>
<p>The fundamental building block of a bitcoin transaction is a  <em>transaction output</em>. Transaction outputs are indivisible chunks of bitcoin currency, recorded on the blockchain, and recognized as valid by the entire network. Bitcoin full nodes track all available and spendable outputs, known as <em>unspent transaction outputs</em>, or <em>UTXO</em>. The collection of all UTXO is known as the <em>UTXO set</em> and currently numbers in the millions of UTXO. The UTXO set grows as new UTXO is created and shrinks when UTXO is consumed. Every transaction represents a change (state transition) in the UTXO set.</p>
</div>
<div>
<p>When we say that a user‚Äôs wallet has "received" bitcoin, what we mean is that the wallet has detected an UTXO that can be spent with one of the keys controlled by that wallet. Thus, a user‚Äôs bitcoin "balance" is the sum of all UTXO that user‚Äôs wallet can spend and which may be scattered among hundreds of transactions and hundreds of blocks. The concept of a balance is created by the wallet application. The wallet calculates the user‚Äôs balance by scanning the blockchain and aggregating the value of any UTXO the wallet can spend with the keys it controls. Most wallets maintain a database or use a database service to store a quick reference set of all the UTXO they can spend with the keys they control.</p>
</div>
<div>
<p>A transaction output can have an arbitrary (integer) value denominated as a multiple of satoshis.  Just as dollars can be divided down to two decimal places as cents, bitcoin can be divided down to eight decimal places as satoshis. Although an output can have any arbitrary value, once created it is indivisible. This is an important characteristic of outputs that needs to be emphasized: outputs are <em>discrete</em> and <em>indivisible</em> units of value, denominated in integer satoshis. An unspent output can only be consumed in its entirety by a transaction.</p>
</div>
<div>
<p>If an UTXO is larger than the desired value of a transaction, it must still be consumed in its entirety and change must be generated in the transaction. In other words, if you have an UTXO worth 20 bitcoin and want to pay only 1 bitcoin, your transaction must consume the entire 20-bitcoin UTXO and produce two outputs: one paying 1 bitcoin to your desired recipient and another paying 19 bitcoin in change back to your wallet. As a result of the indivisible nature of transaction outputs, most bitcoin transactions will have to generate change.</p>
</div>
<div>
<p>Imagine a shopper buying a $1.50 beverage, reaching into her wallet and trying to find a combination of coins and bank notes to cover the $1.50 cost. The shopper will choose exact change if available e.g. a dollar bill and two quarters (a quarter is $0.25), or a combination of smaller denominations (six quarters), or if necessary, a larger unit such as a $5 note. If she hands too much money, say $5, to the shop owner, she will expect $3.50 change, which she will return to her wallet and have available for future transactions.</p>
</div>
<div>
<p>Similarly, a bitcoin transaction must be created from a user‚Äôs UTXO in whatever denominations that user has available. Users cannot cut an UTXO in half any more than they can cut a dollar bill in half and use it as currency. The user‚Äôs wallet application will typically select from the user‚Äôs available UTXO to compose an amount greater than or equal to the desired transaction amount.</p>
</div>
<div>
<p>As with real life, the bitcoin application can use several strategies to satisfy the purchase amount: combining several smaller units, finding exact change, or using a single unit larger than the transaction value and making change. All of this complex assembly of spendable UTXO is done by the user‚Äôs wallet automatically and is invisible to users. It is only relevant if you are programmatically constructing raw transactions from UTXO.</p>
</div>
<div>
<p>A transaction consumes previously recorded unspent transaction outputs and creates new transaction outputs that can be consumed by a future transaction. This way, chunks of bitcoin value move forward from owner to owner in a chain of transactions consuming and creating UTXO.</p>
</div>
<div>
<p>The exception to the output and input chain is a special type of transaction called the <em>coinbase</em> transaction, which is the first transaction in each block. This transaction is placed there by the "winning" miner and creates brand-new bitcoin payable to that miner as a reward for mining. This special coinbase transaction does not consume UTXO; instead, it has a special type of input called the "coinbase." This is how bitcoin‚Äôs money supply is created during the mining process, as we will see in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#mining">[mining]</a>.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>What comes first? Inputs or outputs, the chicken or the egg? Strictly speaking, outputs come first because coinbase transactions, which generate new bitcoin, have no inputs and create outputs from nothing.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<h4 id="user-content-tx_outs"><a id="user-content-transaction-outputs" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-outputs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Outputs</h4>
<div>
<p>Every bitcoin transaction creates outputs, which are recorded on the bitcoin ledger. Almost all of these outputs, with one exception (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#op_return">[op_return]</a>) create spendable chunks of bitcoin called UTXO, which are then recognized by the whole network and available for the owner to spend in a future transaction.</p>
</div>
<div>
<p>UTXO are tracked by every full-node bitcoin client in the UTXO set. New transactions consume (spend) one or more of these outputs from the UTXO set.</p>
</div>
<div>
<p>Transaction outputs consist of two parts:</p>
</div>
<div>
<ul>
<li>
<p>An amount of bitcoin, denominated in <em>satoshis</em>, the smallest bitcoin unit</p>
</li>
<li>
<p>A cryptographic puzzle that determines the conditions required to spend the output</p>
</li>
</ul>
</div>
<div>
<p>The cryptographic puzzle is also known as a  <em>locking script</em>, a <em>witness script</em>, or a scriptPubKey.</p>
</div>
<div>
<p>The transaction scripting language, used in the locking script mentioned previously, is discussed in detail in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_script">Transaction Scripts and Script Language</a>.</p>
</div>
<div>
<p>Now, let‚Äôs look at Alice‚Äôs transaction (shown previously in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transactions_behind_the_scenes">Transactions‚ÄîBehind the Scenes</a>) and see if we can identify the outputs. In the JSON encoding, the outputs are in an array (list) named vout:</p>
</div>
<div>
<div>
<div class="highlight highlight-source-json"><pre><span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: [
  {
    <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">0.01500000</span>,
    <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY</span>
<span class="pl-s">    OP_CHECKSIG<span class="pl-pds">"</span></span>
  },
  {
    <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">0.08450000</span>,
    <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG<span class="pl-pds">"</span></span>,
  }
]</pre></div>
</div>
</div>
<div>
<p>As you can see, the transaction contains two outputs. Each output is defined by a value and a cryptographic puzzle. In the encoding shown by Bitcoin Core, the value is shown in bitcoin, but in the transaction itself it is recorded as an integer denominated in satoshis. The second part of each output is the cryptographic puzzle that sets the conditions for spending. Bitcoin Core shows this as scriptPubKey and shows us a human-readable representation of the script.</p>
</div>
<div>
<p>The topic of locking and unlocking UTXO will be discussed later, in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_lock_unlock">Script Construction (Lock + Unlock)</a>. The scripting language that is used for the script in scriptPubKey is discussed in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_script">Transaction Scripts and Script Language</a>. But before we delve into those topics, we need to understand the overall structure of transaction inputs and outputs.</p>
</div>
<div>
<h5 id="user-content-transaction-serializationoutputs"><a id="user-content-transaction-serializationoutputs" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-serializationoutputs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction serialization‚Äîoutputs</h5>
<div>
<p>When transactions are transmitted over the network or exchanged between applications, they are <em>serialized</em>. Serialization is the process of converting the internal representation of a data structure into a format that can be transmitted one byte at a time, also known as a byte stream. Serialization is most commonly used for encoding data structures for transmission over a network or for storage in a file. The serialization format of a transaction output is shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_out_structure">Transaction output serialization</a>.</p>
</div>

Table 1. Transaction output serialization





<table id="user-content-tx_out_structure"><thead>
<tr>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>8 bytes (little-endian)</p></td>
<td><p>Amount</p></td>
<td><p>Bitcoin value in satoshis (10<sup>-8</sup> bitcoin)</p></td>
</tr>
<tr>
<td><p>1‚Äì9 bytes (VarInt)</p></td>
<td><p>Locking-Script Size</p></td>
<td><p>Locking-Script length in bytes, to follow</p></td>
</tr>
<tr>
<td><p>Variable</p></td>
<td><p>Locking-Script</p></td>
<td><p>A script defining the conditions needed to spend the output</p></td>
</tr>
</tbody>
</table>
<div>
<p>Most bitcoin libraries and frameworks do not store transactions internally as byte-streams, as that would require complex parsing every time you needed to access a single field. For convenience and readability, bitcoin libraries store transactions internally in data structures (usually object-oriented structures).</p>
</div>
<div>
<p>The process of converting from the byte-stream representation of a transaction to a library‚Äôs internal representation data structure is called <em>deserialization</em> or <em>transaction parsing</em>. The process of converting back to a byte-stream for transmission over the network, for hashing, or for storage on disk is called <em>serialization</em>.  Most bitcoin libraries have built-in functions for transaction serialization and deserialization.</p>
</div>
<div>
<p>See if you can manually decode Alice‚Äôs transaction from the serialized hexadecimal form, finding some of the elements we saw previously. The section containing the two outputs is highlighted in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#example_6_1">Alice‚Äôs transaction, serialized and presented in hexadecimal notation</a> to help you:</p>
</div>
<div id="user-content-example_6_1">
<div>Example 1. Alice‚Äôs transaction, serialized and presented in hexadecimal notation</div>
<div>
<div>
<p>0100000001186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73
4d2804fe65fa35779000000008b483045022100884d142d86652a3f47
ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039
ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813
01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84
16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1
7b4a10fa336a8d752adfffffffff02<strong>60e31600000000001976a914ab6</strong>
<strong>8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000</strong>
<strong>1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac</strong>
00000000</p>
</div>
</div>
</div>
<div>
<p>Here are some hints:</p>
</div>
<div>
<ul>
<li>
<p>There are two outputs in the highlighted section, each serialized as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_out_structure">Transaction output serialization</a>.</p>
</li>
<li>
<p>The value of 0.015 bitcoin is 1,500,000 satoshis. That‚Äôs 16 e3 60 in hexadecimal.</p>
</li>
<li>
<p>In the serialized transaction, the value 16 e3 60 is encoded in little-endian (least-significant-byte-first) byte order, so it looks like 60 e3 16.</p>
</li>
<li>
<p>The scriptPubKey length is 25 bytes, which is 19 in hexadecimal.</p>
</li>
</ul>
</div>
</div>
</div>
<div>
<h4 id="user-content-tx_inputs"><a id="user-content-transaction-inputs" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-inputs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Inputs</h4>
<div>
<p>Transaction inputs identify (by reference) which UTXO will be consumed and provide proof of ownership through an unlocking script.</p>
</div>
<div>
<p>To build a transaction, a wallet selects from the UTXO it controls, UTXO with enough value to make the requested payment. Sometimes one UTXO is enough, other times more than one is needed. For each UTXO that will be consumed to make this payment, the wallet creates one input pointing to the UTXO and unlocks it with an unlocking script.</p>
</div>
<div>
<p>Let‚Äôs look at the components of an input in greater detail. The first part of an input is a pointer to an UTXO by reference to the transaction hash and an output index, which identifies the specific UTXO in that transaction. The second part is an unlocking script, which the wallet constructs in order to satisfy the spending conditions set in the UTXO. Most often, the unlocking script is a digital signature and public key proving ownership of the bitcoin. However, not all unlocking scripts contain signatures. The third part is a sequence number, which will be discussed later.</p>
</div>
<div>
<p>Consider our example in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transactions_behind_the_scenes">Transactions‚ÄîBehind the Scenes</a>. The transaction inputs are an array (list) called vin:</p>
</div>
<div id="user-content-vin">
<div>The transaction inputs in Alice‚Äôs transaction</div>
<div>
<div class="highlight highlight-source-json"><pre><span class="pl-s"><span class="pl-pds">"</span>vin<span class="pl-pds">"</span></span>: [
  {
    <span class="pl-s"><span class="pl-pds">"</span>txid<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
    <span class="pl-s"><span class="pl-pds">"</span>scriptSig<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>sequence<span class="pl-pds">"</span></span>: <span class="pl-c1">4294967295</span>
  }
]</pre></div>
</div>
</div>
<div>
<p>As you can see, there is only one input in the list (because one UTXO contained sufficient value to make this payment). The input contains four elements:</p>
</div>
<div>
<ul>
<li>
<p>A transaction ID, referencing the transaction that contains the UTXO being spent</p>
</li>
<li>
<p>An output index (vout), identifying which UTXO from that transaction is referenced (first one is zero)</p>
</li>
<li>
<p>A scriptSig, which satisfies the conditions placed on the UTXO, unlocking it for spending</p>
</li>
<li>
<p>A sequence number (to be discussed later)</p>
</li>
</ul>
</div>
<div>
<p>In Alice‚Äôs transaction, the input points to the transaction ID:</p>
</div>
<div>
<div>
<pre>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18</pre>
</div>
</div>
<div>
<p>and output index 0 (i.e., the first UTXO created by that transaction). The unlocking script is constructed by Alice‚Äôs wallet by first retrieving the referenced UTXO, examining its locking script, and then using it to build the necessary unlocking script to satisfy it.</p>
</div>
<div>
<p>Looking just at the input you may have noticed that we don‚Äôt know anything about this UTXO, other than a reference to the transaction containing it. We don‚Äôt know its value (amount in satoshi), and we don‚Äôt know the locking script that sets the conditions for spending it. To find this information, we must retrieve the referenced UTXO by retrieving the underlying transaction. Notice that because the value of the input is not explicitly stated, we must also use the referenced UTXO in order to calculate the fees that will be paid in this transaction (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_fees">Transaction Fees</a>).</p>
</div>
<div>
<p>It‚Äôs not just Alice‚Äôs wallet that needs to retrieve UTXO referenced in the inputs. Once this transaction is broadcast to the network, every validating node will also need to retrieve the UTXO referenced in the transaction inputs in order to validate the transaction.</p>
</div>
<div>
<p>Transactions on their own seem incomplete because they lack context. They reference UTXO in their inputs but without retrieving that UTXO we cannot know the value of the inputs or their locking conditions. When writing bitcoin software, anytime you decode a transaction with the intent of validating it or counting the fees or checking the unlocking script, your code will first have to retrieve the referenced UTXO from the blockchain in order to build the context implied but not present in the UTXO references of the inputs. For example, to calculate the amount paid in fees, you must know the sum of the values of inputs and outputs. But without retrieving the UTXO referenced in the inputs, you do not know their value. So a seemingly simple operation like counting fees in a single transaction in fact involves multiple steps and data from multiple transactions.</p>
</div>
<div>
<p>We can use the same sequence of commands with Bitcoin Core as we used when retrieving Alice‚Äôs transaction (getrawtransaction and decoderawtransaction). With that we can get the UTXO referenced in the preceding input and take a look:</p>
</div>
<div id="user-content-alice_input_tx">
<div>Alice‚Äôs UTXO from the previous transaction, referenced in the input</div>
<div>
<div class="highlight highlight-source-json"><pre><span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: [
   {
     <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">0.10000000</span>,
     <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG<span class="pl-pds">"</span></span>
   }
 ]</pre></div>
</div>
</div>
<div>
<p>We see that this UTXO has a value of 0.1 BTC and that it has a locking script (scriptPubKey) that contains "OP_DUP OP_HASH160‚Ä¶‚Äã".</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>To fully understand Alice‚Äôs transaction we had to retrieve the previous transaction(s) referenced as inputs. A function that retrieves previous transactions and unspent transaction outputs is very common and exists in almost every bitcoin library and API.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<h5 id="user-content-transaction-serializationinputs"><a id="user-content-transaction-serializationinputs" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-serializationinputs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction serialization‚Äîinputs</h5>
<div>
<p>When transactions are serialized for transmission on the network, their inputs are encoded into a byte stream as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_in_structure">Transaction input serialization</a>.</p>
</div>

Table 2. Transaction input serialization





<table id="user-content-tx_in_structure"><thead>
<tr>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>32 bytes</p></td>
<td><p>Transaction Hash</p></td>
<td><p>Pointer to the transaction containing the UTXO to be spent</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Output Index</p></td>
<td><p>The index number of the UTXO to be spent; first one is 0</p></td>
</tr>
<tr>
<td><p>1‚Äì9 bytes (VarInt)</p></td>
<td><p>Unlocking-Script Size</p></td>
<td><p>Unlocking-Script length in bytes, to follow</p></td>
</tr>
<tr>
<td><p>Variable</p></td>
<td><p>Unlocking-Script</p></td>
<td><p>A script that fulfills the conditions of the UTXO locking script</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Sequence Number</p></td>
<td><p>Used for locktime or disabled (0xFFFFFFFF)</p></td>
</tr>
</tbody>
</table>
<div>
<p>As with the outputs, let‚Äôs see if we can find the inputs from Alice‚Äôs transaction in the serialized format. First, the inputs decoded:</p>
</div>
<div>
<div>
<div class="highlight highlight-source-json"><pre><span class="pl-s"><span class="pl-pds">"</span>vin<span class="pl-pds">"</span></span>: [
  {
    <span class="pl-s"><span class="pl-pds">"</span>txid<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span>: <span class="pl-c1">0</span>,
    <span class="pl-s"><span class="pl-pds">"</span>scriptSig<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>sequence<span class="pl-pds">"</span></span>: <span class="pl-c1">4294967295</span>
  }
],</pre></div>
</div>
</div>
<div>
<p>Now, let‚Äôs see if we can identify these fields in the serialized hex encoding in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#example_6_2">Alice‚Äôs transaction, serialized and presented in hexadecimal notation</a>:</p>
</div>
<div id="user-content-example_6_2">
<div>Example 2. Alice‚Äôs transaction, serialized and presented in hexadecimal notation</div>
<div>
<div>
<p>0100000001<strong>186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73</strong>
<strong>4d2804fe65fa35779000000008b483045022100884d142d86652a3f47</strong>
<strong>ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039</strong>
<strong>ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</strong>
<strong>01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84</strong>
<strong>16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1</strong>
<strong>7b4a10fa336a8d752adfffffffff</strong>0260e31600000000001976a914ab6
8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000
1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac00000
000</p>
</div>
</div>
</div>
<div>
<p>Hints:</p>
</div>
<div>
<ul>
<li>
<p>The transaction ID is serialized in reversed byte order, so it starts with (hex) 18 and ends with 79</p>
</li>
<li>
<p>The output index is a 4-byte group of zeros, easy to identify</p>
</li>
<li>
<p>The length of the scriptSig is 139 bytes, or 8b in hex</p>
</li>
<li>
<p>The sequence number is set to FFFFFFFF, again easy to identify</p>
</li>
</ul>
</div>
</div>
</div>
<div>
<h4 id="user-content-tx_fees"><a id="user-content-transaction-fees" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-fees"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Fees</h4>
<div>
<p>Most transactions include transaction fees, which compensate the bitcoin miners for securing the network. Fees also serve as a security mechanism themselves, by making it economically infeasible for attackers to flood the network with transactions. Mining and the fees and rewards collected by miners are discussed in more detail in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#mining">[mining]</a>.</p>
</div>
<div>
<p>This section examines how transaction fees are included in a typical transaction. Most wallets calculate and include transaction fees automatically. However, if you are constructing transactions programmatically, or using a command-line interface, you must manually account for and include these fees.</p>
</div>
<div>
<p>Transaction fees serve as an incentive to include (mine) a transaction into the next block and also as a disincentive against abuse of the system by imposing a small cost on every transaction. Transaction fees are collected by the miner who mines the block that records the transaction on the blockchain.</p>
</div>
<div>
<p>Transaction fees are calculated based on the size of the transaction in kilobytes, not the value of the transaction in bitcoin. Overall, transaction fees are set based on market forces within the bitcoin network. Miners prioritize transactions based on many different criteria, including fees, and might even process transactions for free under certain circumstances. Transaction fees affect the processing priority, meaning that a transaction with sufficient fees is likely to be included in the next block mined, whereas a transaction with insufficient or no fees might be delayed, processed on a best-effort basis after a few blocks, or not processed at all. Transaction fees are not mandatory, and transactions without fees might be processed eventually; however, including transaction fees encourages priority processing.</p>
</div>
<div>
<p>Over time, the way transaction fees are calculated and the effect they have on transaction prioritization has evolved. At first, transaction fees were fixed and constant across the network. Gradually, the fee structure relaxed and may be influenced by market forces, based on network capacity and transaction volume. Since at least the beginning of 2016, capacity limits in bitcoin have created competition between transactions, resulting in higher fees and effectively making free transactions a thing of the past. Zero fee or very low fee transactions rarely get mined and sometimes will not even be propagated across the network.</p>
</div>
<div>
<p>In Bitcoin Core, fee relay policies are set by the minrelaytxfee option. The current default minrelaytxfee is 0.00001 bitcoin or a hundredth of a millibitcoin per kilobyte. Therefore, by default, transactions with a fee less than 0.00001 bitcoin are treated as free and are only relayed if there is space in the mempool; otherwise, they are dropped. Bitcoin nodes can override the default fee relay policy by adjusting the value of minrelaytxfee.</p>
</div>
<div>
<p>Any bitcoin service that creates transactions, including wallets, exchanges, retail applications, etc., <em>must</em> implement dynamic fees. Dynamic fees can be implemented through a third-party fee estimation service or with a built-in fee estimation algorithm. If you‚Äôre unsure, begin with a third-party service and as you gain experience design and implement your own algorithm if you wish to remove the third-party dependency.</p>
</div>
<div>
<p>Fee estimation algorithms calculate the appropriate fee, based on capacity and the fees offered by "competing" transactions. These algorithms range from simplistic (average or median fee in the last block) to sophisticated (statistical analysis). They estimate the necessary fee (in satoshis per byte) that will give a transaction a high probability of being selected and included within a certain number of blocks. Most services offer users the option of choosing high, medium, or low priority fees. High priority means users pay higher fees but the transaction is likely to be included in the next block. Medium and low priority means users pay lower transaction fees but the transactions may take much longer to confirm.</p>
</div>
<div>
<p>Many wallet applications use third-party services for fee calculations. One popular service is <a href="https://bitcoinfees.21.co/" rel="nofollow"><em>https://bitcoinfees.21.co/</em></a>, which provides an API and a visual chart showing the fee in satoshi/byte for different priorities.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>Static fees are no longer viable on the bitcoin network. Wallets that set static fees will produce a poor user experience as transactions will often get "stuck" and remain unconfirmed. Users who don‚Äôt understand bitcoin transactions and fees are dismayed by "stuck" transactions because they think they‚Äôve lost their money.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>The chart in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#bitcoinfees21co">Fee estimation service bitcoinfees.21.co</a> shows the real-time estimate of fees in 10 satoshi/byte increments and the expected confirmation time (in minutes and number of blocks) for transactions with fees in each range. For each fee range (e.g., 61‚Äì70 satoshi/byte), two horizontal bars show the number of unconfirmed transactions (1405) and total number of transactions in the past 24 hours (102,975), with fees in that range. Based on the graph, the recommended high-priority fee at this time was 80 satoshi/byte, a fee likely to result in the transaction being mined in the very next block (zero block delay). For perspective, the median transaction size is 226 bytes, so the recommended fee for a transaction size would be 18,080 satoshis (0.00018080 BTC).</p>
</div>
<div>
<p>The fee estimation data can be retrieved via a simple HTTP REST API, at <a href="https://bitcoinfees.21.co/api/v1/fees/recommended" rel="nofollow">https://bitcoinfees.21.co/api/v1/fees/recommended</a>. For example, on the command line using the curl command:</p>
</div>
<div>
<div>Using the fee estimation API</div>
<div>
<pre>$ curl https://bitcoinfees.21.co/api/v1/fees/recommended

{"fastestFee":80,"halfHourFee":80,"hourFee":60}</pre>
</div>
</div>
<div>
<p>The API returns a JSON object with the current fee estimate for fastest confirmation (fastestFee), confirmation within three blocks (halfHourFee) and six blocks (hourFee), in satoshi per byte.</p>
</div>
<div id="user-content-bitcoinfees21co">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0602.png"><img src="./Transactions_files/mbc2_0602.png" alt="Fee Estimation Service bitcoinfees.21.co" style="max-width:100%;"></a>
</div>
<div>Figure 2. Fee estimation service bitcoinfees.21.co</div>
</div>
</div>
<div>
<h4 id="user-content-adding-fees-to-transactions"><a id="user-content-adding-fees-to-transactions" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#adding-fees-to-transactions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding Fees to Transactions</h4>
<div>
<p>The data structure of transactions does not have a field for fees. Instead, fees are implied as the difference between the sum of inputs and the sum of outputs. Any excess amount that remains after all outputs have been deducted from all inputs is the fee that is collected by the miners:</p>
</div>
<div id="user-content-tx_fee_equation">
<div>Transaction fees are implied, as the excess of inputs minus outputs:</div>
<div>
<pre>Fees = Sum(Inputs) ‚Äì Sum(Outputs)</pre>
</div>
</div>
<div>
<p>This is a somewhat confusing element of transactions and an important point to understand, because if you are constructing your own transactions you must ensure you do not inadvertently include a very large fee by underspending the inputs. That means that you must account for all inputs, if necessary by creating change, or you will end up giving the miners a very big tip!</p>
</div>
<div>
<p>For example, if you consume a 20-bitcoin UTXO to make a 1-bitcoin payment, you must include a 19-bitcoin change output back to your wallet. Otherwise, the 19-bitcoin "leftover" will be counted as a transaction fee and will be collected by the miner who mines your transaction in a block. Although you will receive priority processing and make a miner very happy, this is probably not what you intended.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Warning</div>
</td>
<td>
<div>
<p>If you forget to add a change output in a manually constructed transaction, you will be paying the change as a transaction fee. "Keep the change!" might not be what you intended.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Let‚Äôs see how this works in practice, by looking at Alice‚Äôs coffee purchase again. Alice wants to spend 0.015 bitcoin to pay for coffee. To ensure this transaction is processed promptly, she will want to include a transaction fee, say 0.001. That will mean that the total cost of the transaction will be 0.016. Her wallet must therefore source a set of UTXO that adds up to 0.016 bitcoin or more and, if necessary, create change. Let‚Äôs say her wallet has a 0.2-bitcoin UTXO available. It will therefore need to consume this UTXO, create one output to Bob‚Äôs Cafe for 0.015, and a second output with 0.184 bitcoin in change back to her own wallet, leaving 0.001 bitcoin unallocated, as an implicit fee for the transaction.</p>
</div>
<div>
<p>Now let‚Äôs look at a different scenario. Eugenia, our children‚Äôs charity director in the Philippines, has completed a fundraiser to purchase schoolbooks for the children. She received several thousand small donations from people all around the world, totaling 50 bitcoin, so her wallet is full of very small payments (UTXO). Now she wants to purchase hundreds of schoolbooks from a local publisher, paying in bitcoin.</p>
</div>
<div>
<p>As Eugenia‚Äôs wallet application tries to construct a single larger payment transaction, it must source from the available UTXO set, which is composed of many smaller amounts. That means that the resulting transaction will source from more than a hundred small-value UTXO as inputs and only one output, paying the book publisher. A transaction with that many inputs will be larger than one kilobyte, perhaps several kilobytes in size. As a result, it will require a much higher fee than the median-sized transaction.</p>
</div>
<div>
<p>Eugenia‚Äôs wallet application will calculate the appropriate fee by measuring the size of the transaction and multiplying that by the per-kilobyte fee. Many wallets will overpay fees for larger transactions to ensure the transaction is processed promptly. The higher fee is not because Eugenia is spending more money, but because her transaction is more complex and larger in size‚Äî‚Äãthe fee is independent of the transaction‚Äôs bitcoin value.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-tx_script"><a id="user-content-transaction-scripts-and-script-language" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction-scripts-and-script-language"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Scripts and Script Language</h3>
<div>
<p>The bitcoin transaction script language, called <em>Script</em>, is a Forth-like reverse-polish notation stack-based execution language. If that sounds like gibberish, you probably haven‚Äôt studied 1960s programming languages, but that‚Äôs ok‚Äîwe will explain it all in this chapter. Both the locking script placed on an UTXO and the unlocking script are written in this scripting language. When a transaction is validated, the unlocking script in each input is executed alongside the corresponding locking script to see if it satisfies the spending condition.</p>
</div>
<div>
<p>Script is a very simple language that was designed to be limited in scope and executable on a range of hardware, perhaps as simple as an embedded device. It requires minimal processing and cannot do many of the fancy things modern programming languages can do. For its use in validating programmable money, this is a deliberate security feature.</p>
</div>
<div>
<p>Today, most transactions processed through the bitcoin network have the form "Payment to Bob‚Äôs bitcoin address" and are based on a script called a Pay-to-Public-Key-Hash script.  However, bitcoin transactions are not limited to the "Payment to Bob‚Äôs bitcoin address" script. In fact, locking scripts can be written to express a vast variety of complex conditions. In order to understand these more complex scripts, we must first understand the basics of transaction scripts and script language.</p>
</div>
<div>
<p>In this section, we will demonstrate the basic components of the bitcoin transaction scripting language and show how it can be used to express simple conditions for spending and how those conditions can be satisfied by unlocking scripts.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>Bitcoin transaction validation is not based on a static pattern, but instead is achieved through the execution of a scripting language. This language allows for a nearly infinite variety of conditions to be expressed. This is how bitcoin gets the power of "programmable money."</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<h4 id="user-content-turing-incompleteness"><a id="user-content-turing-incompleteness" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#turing-incompleteness"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Turing Incompleteness</h4>
<div>
<p>The bitcoin transaction script language contains many operators, but is deliberately limited in one important way‚Äî‚Äãthere are no loops or complex flow control capabilities other than conditional flow control. This ensures that the language is not <em>Turing Complete</em>, meaning that scripts have limited complexity and predictable execution times. Script is not a general-purpose language. These limitations ensure that the language cannot be used to create an infinite loop or other form of "logic bomb" that could be embedded in a transaction in a way that causes a denial-of-service attack against the bitcoin network. Remember, every transaction is validated by every full node on the bitcoin network. A limited language prevents the transaction validation mechanism from being used as a vulnerability.</p>
</div>
</div>
<div>
<h4 id="user-content-stateless-verification"><a id="user-content-stateless-verification" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#stateless-verification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Stateless Verification</h4>
<div>
<p>The bitcoin transaction script language is stateless, in that there is no state prior to execution of the script, or state saved after execution of the script. Therefore, all the information needed to execute a script is contained within the script. A script will predictably execute the same way on any system. If your system verifies a script, you can be sure that every other system in the bitcoin network will also verify the script, meaning that a valid transaction is valid for everyone and everyone knows this. This predictability of outcomes is an essential benefit of the bitcoin system.</p>
</div>
</div>
<div>
<h4 id="user-content-tx_lock_unlock"><a id="user-content-script-construction-lock--unlock" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#script-construction-lock--unlock"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Script Construction (Lock + Unlock)</h4>
<div>
<p>Bitcoin‚Äôs transaction validation engine relies on two types of scripts to validate transactions: a locking script and an unlocking script.</p>
</div>
<div>
<p>A locking script is a spending condition placed on an output: it specifies the conditions that must be met to spend the output in the future. Historically, the locking script was called a <em>scriptPubKey</em>, because it usually contained a public key or bitcoin address (public key hash). In this book we refer to it as a "locking script" to acknowledge the much broader range of possibilities of this scripting technology. In most bitcoin applications, what we refer to as a locking script will appear in the source code as scriptPubKey. You will also see the locking script referred to as a <em>witness script</em> (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#segwit">[segwit]</a>) or more generally as a <em>cryptographic puzzle</em>. These terms all mean the same thing, at different levels of abstraction.</p>
</div>
<div>
<p>An unlocking script is a script that "solves," or satisfies, the conditions placed on an output by a locking script and allows the output to be spent. Unlocking scripts are part of every transaction input. Most of the time they contain a digital signature produced by the user‚Äôs wallet from his or her private key. Historically, the unlocking script was called <em>scriptSig</em>, because it usually contained a digital signature. In most bitcoin applications, the source code refers to the unlocking script as scriptSig. You will also see the unlocking script referred to as a <em>witness</em> (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#segwit">[segwit]</a>). In this book, we refer to it as an "unlocking script" to acknowledge the much broader range of locking script requirements, because not all unlocking scripts must contain signatures.</p>
</div>
<div>
<p>Every bitcoin validating node will validate transactions by executing the locking and unlocking scripts together. Each input contains an unlocking script and refers to a previously existing UTXO. The validation software will copy the unlocking script, retrieve the UTXO referenced by the input, and copy the locking script from that UTXO. The unlocking and locking script are then executed in sequence. The input is valid if the unlocking script satisfies the locking script conditions (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#script_exec">Separate execution of unlocking and locking scripts</a>). All the inputs are validated independently, as part of the overall validation of the transaction.</p>
</div>
<div>
<p>Note that the UTXO is permanently recorded in the blockchain, and therefore is invariable and is unaffected by failed attempts to spend it by reference in a new transaction. Only a valid transaction that correctly satisfies the conditions of the output results in the output being considered as "spent" and removed from the set of unspent transaction outputs (UTXO set).</p>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#scriptSig_and_scriptPubKey">Combining scriptSig and scriptPubKey to evaluate a transaction script</a> is an example of the unlocking and locking scripts for the most common type of bitcoin transaction (a payment to a public key hash), showing the combined script resulting from the concatenation of the unlocking and locking scripts prior to script validation.</p>
</div>
<div id="user-content-scriptsig_and_scriptpubkey">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0603.png"><img src="./Transactions_files/mbc2_0603.png" alt="scriptSig_and_scriptPubKey" style="max-width:100%;"></a>
</div>
<div>Figure 3. Combining scriptSig and scriptPubKey to evaluate a transaction script</div>
</div>
<div>
<h5 id="user-content-the-script-execution-stack"><a id="user-content-the-script-execution-stack" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#the-script-execution-stack"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The script execution stack</h5>
<div>
<p>Bitcoin‚Äôs scripting language is called a stack-based language because it uses a data structure called a <em>stack</em>. A stack is a very simple data structure that can be visualized as a stack of cards. A stack allows two operations: push and pop. Push adds an item on top of the stack. Pop removes the top item from the stack. Operations on a stack can only act on the topmost item on the stack. A stack data structure is also called a Last-In-First-Out, or "LIFO" queue.</p>
</div>
<div>
<p>The scripting language executes the script by processing each item from left to right. Numbers (data constants) are pushed onto the stack. Operators push or pop one or more parameters from the stack, act on them, and might push a result onto the stack. For example, OP_ADD will pop two items from the stack, add them, and push the resulting sum onto the stack.</p>
</div>
<div>
<p>Conditional operators evaluate a condition, producing a boolean result of TRUE or FALSE. For example, OP_EQUAL pops two items from the stack and pushes TRUE (TRUE is represented by the number 1) if they are equal or FALSE (represented by zero) if they are not equal. Bitcoin transaction scripts usually contain a conditional operator, so that they can produce the TRUE result that signifies a valid transaction.</p>
</div>
</div>
<div>
<h5 id="user-content-a-simple-script"><a id="user-content-a-simple-script" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#a-simple-script"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A simple script</h5>
<div>
<p>Now let‚Äôs apply what we‚Äôve learned about scripts and stacks to some simple examples.</p>
</div>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#simplemath_script">Bitcoin‚Äôs script validation doing simple math</a>, the script 2 3 OP_ADD 5 OP_EQUAL demonstrates the arithmetic addition operator OP_ADD, adding two numbers and putting the result on the stack, followed by the conditional operator OP_EQUAL, which checks that the resulting sum is equal to 5. For brevity, the OP_ prefix is omitted in the step-by-step example. For more details on the available script operators and functions, see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_script_ops">[tx_script_ops]</a>.</p>
</div>
<div>
<p>Although most locking scripts refer to a public key hash (essentially, a bitcoin address), thereby requiring proof of ownership to spend the funds, the script does not have to be that complex. Any combination of locking and unlocking scripts that results in a TRUE value is valid. The simple arithmetic we used as an example of the scripting language is also a valid locking script that can be used to lock a transaction output.</p>
</div>
<div>
<p>Use part of the arithmetic example script as the locking script:</p>
</div>
<div>
<div>
<pre>3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div>
<p>which can be satisfied by a transaction containing an input with the unlocking script:</p>
</div>
<div>
<div>
<pre>2</pre>
</div>
</div>
<div>
<p>The validation software combines the locking and unlocking scripts and the resulting script is:</p>
</div>
<div>
<div>
<pre>2 3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div>
<p>As we saw in the step-by-step example in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#simplemath_script">Bitcoin‚Äôs script validation doing simple math</a>, when this script is executed, the result is OP_TRUE, making the transaction valid. Not only is this a valid transaction output locking script, but the resulting UTXO could be spent by anyone with the arithmetic skills to know that the number 2 satisfies the script.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>Transactions are valid if the top result on the stack is TRUE (noted as &amp;#x7b;0x01&amp;#x7d;), any other nonzero value, or if the stack is empty after script execution. Transactions are invalid if the top value on the stack is FALSE (a zero-length empty value, noted as &amp;#x7b;&amp;#x7d;) or if script execution is halted explicitly by an operator, such as OP_VERIFY, OP_RETURN, or a conditional terminator such as OP_ENDIF. See <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#tx_script_ops">[tx_script_ops]</a> for details.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="user-content-simplemath_script">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0604.png"><img src="./Transactions_files/mbc2_0604.png" alt="TxScriptSimpleMathExample" style="max-width:100%;"></a>
</div>
<div>Figure 4. Bitcoin‚Äôs script validation doing simple math</div>
</div>
<div>
<p>The following is a slightly more complex script, which calculates 2 + 7 - 3 + 1. Notice that when the script contains several operators in a row, the stack allows the results of one operator to be acted upon by the next operator:</p>
</div>
<div>
<div>
<pre>2 7 OP_ADD 3 OP_SUB 1 OP_ADD 7 OP_EQUAL</pre>
</div>
</div>
<div>
<p>Try validating the preceding script yourself using pencil and paper. When the script execution ends, you should be left with the value TRUE on the stack.</p>
</div>
</div>
<div>
<h5 id="user-content-script_exec"><a id="user-content-separate-execution-of-unlocking-and-locking-scripts" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#separate-execution-of-unlocking-and-locking-scripts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Separate execution of unlocking and locking scripts</h5>
<div>
<p>In the original bitcoin client, the unlocking and locking scripts were concatenated and executed in sequence. For security reasons, this was changed in 2010, because of a vulnerability that allowed a malformed unlocking script to push data onto the stack and corrupt the locking script. In the current implementation, the scripts are executed separately with the stack transferred between the two executions, as described next.</p>
</div>
<div>
<p>First, the unlocking script is executed, using the stack execution engine. If the unlocking script is executed without errors (e.g., it has no "dangling" operators left over), the main stack is copied and the locking script is executed. If the result of executing the locking script with the stack data copied from the unlocking script is "TRUE," the unlocking script has succeeded in resolving the conditions imposed by the locking script and, therefore, the input is a valid authorization to spend the UTXO. If any result other than "TRUE" remains after execution of the combined script, the input is invalid because it has failed to satisfy the spending conditions placed on the UTXO.</p>
</div>
</div>
</div>
<div>
<h4 id="user-content-p2pkh"><a id="user-content-pay-to-public-key-hash-p2pkh" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#pay-to-public-key-hash-p2pkh"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pay-to-Public-Key-Hash (P2PKH)</h4>
<div>
<p>The vast majority of transactions processed on the bitcoin network spend outputs locked with a Pay-to-Public-Key-Hash or "P2PKH" script. These outputs contain a locking script that locks the output to a public key hash, more commonly known as a bitcoin address. An output locked by a P2PKH script can be unlocked (spent) by presenting a public key and a digital signature created by the corresponding private key (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#digital_sigs">Digital Signatures (ECDSA)</a>).</p>
</div>
<div>
<p>For example, let‚Äôs look at Alice‚Äôs payment to Bob‚Äôs Cafe again. Alice made a payment of 0.015 bitcoin to the cafe‚Äôs bitcoin address. That transaction output would have a locking script of the form:</p>
</div>
<div>
<div>
<pre>OP_DUP OP_HASH160 &lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div>
<p>The Cafe Public Key Hash is equivalent to the bitcoin address of the cafe, without the Base58Check encoding. Most applications would show the <em>public key hash</em> in hexadecimal encoding and not the familiar bitcoin address Base58Check format that begins with a "1."</p>
</div>
<div>
<p>The preceding locking script can be satisfied with an unlocking script of the form:</p>
</div>
<div>
<div>
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt;</pre>
</div>
</div>
<div>
<p>The two scripts together would form the following combined validation script:</p>
</div>
<div>
<div>
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt; OP_DUP OP_HASH160
&lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div>
<p>When executed, this combined script will evaluate to TRUE if, and only if, the unlocking script matches the conditions set by the locking script. In other words, the result will be TRUE if the unlocking script has a valid signature from the cafe‚Äôs private key that corresponds to the public key hash set as an encumbrance.</p>
</div>
<div>
<p>Figures <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#P2PubKHash1">#P2PubKHash1</a> and <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#P2PubKHash2">#P2PubKHash2</a> show (in two parts) a step-by-step execution of the combined script, which will prove this is a valid transaction.</p>
</div>
<div id="user-content-p2pubkhash1">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0605.png"><img src="./Transactions_files/mbc2_0605.png" alt="Tx_Script_P2PubKeyHash_1" style="max-width:100%;"></a>
</div>
<div>Figure 5. Evaluating a script for a P2PKH transaction (part 1 of 2)</div>
</div>
<div id="user-content-p2pubkhash2">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0606.png"><img src="./Transactions_files/mbc2_0606.png" alt="Tx_Script_P2PubKeyHash_2" style="max-width:100%;"></a>
</div>
<div>Figure 6. Evaluating a script for a P2PKH transaction (part 2 of 2)</div>
</div>
</div>
</div>
<div>
<h3 id="user-content-digital_sigs"><a id="user-content-digital-signatures-ecdsa" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#digital-signatures-ecdsa"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Digital Signatures (ECDSA)</h3>
<div>
<p>So far, we have not delved into any detail about "digital signatures." In this section we look at how digital signatures work and how they can present proof of ownership of a private key without revealing that private key.</p>
</div>
<div>
<p>The digital signature algorithm used in bitcoin is the <em>Elliptic Curve Digital Signature Algorithm</em>, or <em>ECDSA</em>. ECDSA is the algorithm used for digital signatures based on elliptic curve private/public key pairs, as described in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#elliptic_curve">[elliptic_curve]</a>. ECDSA is used by the script functions OP_CHECKSIG, OP_CHECKSIGVERIFY, OP_CHECKMULTISIG, and OP_CHECKMULTISIGVERIFY. Any time you see those in a locking script, the unlocking script must contain an ECDSA signature.</p>
</div>
<div>
<p>A digital signature serves three purposes in bitcoin (see the following sidebar). First, the signature proves that the owner of the private key, who is by implication the owner of the funds, has <em>authorized</em> the spending of those funds. Secondly, the proof of authorization is <em>undeniable</em> (nonrepudiation). Thirdly, the signature proves that the transaction (or specific parts of the transaction) have not and <em>cannot be modified</em> by anyone after it has been signed.</p>
</div>
<div>
<p>Note that each transaction input is signed independently. This is critical, as neither the signatures nor the inputs have to belong to or be applied by the same "owners." In fact, a specific transaction scheme called "CoinJoin" uses this fact to create multi-party transactions for privacy.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>Each transaction input and any signature it may contain is <em>completely</em> independent of any other input or signature. Multiple parties can collaborate to construct transactions and sign only one input each.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="user-content-digital_signature_definition">
<div>
<div>Wikipedia‚Äôs Definition of a "Digital Signature"</div>
<div>
<p>A digital signature is a mathematical scheme for demonstrating the authenticity of a digital message or documents. A valid digital signature gives a recipient reason to believe that the message was created by a known sender (authentication), that the sender cannot deny having sent the message (nonrepudiation), and that the message was not altered in transit (integrity).</p>
</div>
<div>
<p><em>Source: <a href="https://en.wikipedia.org/wiki/Digital_signature" rel="nofollow">https://en.wikipedia.org/wiki/Digital_signature</a></em></p>
</div>
</div>
</div>
<div>
<h4 id="user-content-how-digital-signatures-work"><a id="user-content-how-digital-signatures-work" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#how-digital-signatures-work"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Digital Signatures Work</h4>
<div>
<p>A digital signature is a <em>mathematical scheme</em> that consists of two parts. The first part is an algorithm for creating a signature, using a private key (the signing key), from a message (the transaction). The second part is an algorithm that allows anyone to verify the signature, given also the message and a public key.</p>
</div>
<div>
<h5 id="user-content-creating-a-digital-signature"><a id="user-content-creating-a-digital-signature" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#creating-a-digital-signature"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a digital signature</h5>
<div>
<p>In bitcoin‚Äôs implementation of the ECDSA algorithm, the "message" being signed is the transaction, or more accurately a hash of a specific subset of the data in the transaction (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#sighash_types">Signature Hash Types (SIGHASH)</a>). The signing key is the user‚Äôs private key. The result is the signature:</p>
</div>
<div>
<p>\(\(Sig = F_{sig}(F_{hash}(m), dA)\)\)</p>
</div>
<div>
<p>where:</p>
</div>
<div>
<ul>
<li>
<p><em>dA</em> is the signing private key</p>
</li>
<li>
<p><em>m</em> is the transaction (or parts of it)</p>
</li>
<li>
<p><em>F</em><sub><em>hash</em></sub> is the hashing function</p>
</li>
<li>
<p><em>F</em><sub><em>sig</em></sub> is the signing algorithm</p>
</li>
<li>
<p><em>Sig</em> is the resulting signature</p>
</li>
</ul>
</div>
<div>
<p>More details on the mathematics of ECDSA can be found in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#ecdsa_math">ECDSA Math</a>.</p>
</div>
<div>
<p>The function <em>F</em><sub><em>sig</em></sub> produces a signature Sig that is composed of two values, commonly referred to as R and S:</p>
</div>
<div>
<div>
<pre>Sig = (R, S)</pre>
</div>
</div>
<div>
<p>Now that the two values R and S have been calculated, they are serialized into a byte-stream using an international standard encoding scheme called the <em>Distinguished Encoding Rules</em>, or <em>DER</em>.</p>
</div>
</div>
<div>
<h5 id="user-content-seralization_of_signatures_der"><a id="user-content-serialization-of-signatures-der" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#serialization-of-signatures-der"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serialization of signatures (DER)</h5>
<div>
<p>Let‚Äôs look at the transaction Alice created again. In the transaction input there is an unlocking script that contains the following DER-encoded signature from Alice‚Äôs wallet:</p>
</div>
<div>
<div>
<pre>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e381301</pre>
</div>
</div>
<div>
<p>That signature is a serialized byte-stream of the R and S values produced by Alice‚Äôs wallet to prove she owns the private key authorized to spend that output. The serialization format consists of nine elements as follows:</p>
</div>
<div>
<ul>
<li>
<p>0x30‚Äîindicating the start of a DER sequence</p>
</li>
<li>
<p>0x45‚Äîthe length of the sequence (69 bytes)</p>
</li>
<li>
<p>0x02‚Äîan integer value follows</p>
</li>
<li>
<p>0x21‚Äîthe length of the integer (33 bytes)</p>
</li>
<li>
<p>R‚Äî00884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb</p>
</li>
<li>
<p>0x02‚Äîanother integer follows</p>
</li>
<li>
<p>0x20‚Äîthe length of the integer (32 bytes)</p>
</li>
<li>
<p>S‚Äî4b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</p>
</li>
<li>
<p>A suffix (0x01) indicating the type of hash used (SIGHASH_ALL)</p>
</li>
</ul>
</div>
<div>
<p>See if you can decode Alice‚Äôs serialized (DER-encoded) signature using this list. The important numbers are R and S; the rest of the data is part of the DER encoding scheme.</p>
</div>
</div>
</div>
<div>
<h4 id="user-content-verifying-the-signature"><a id="user-content-verifying-the-signature" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#verifying-the-signature"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verifying the Signature</h4>
<div>
<p>To verify the signature, one must have the signature (R and S), the serialized transaction, and the public key (that corresponds to the private key used to create the signature). Essentially, verification of a signature means "Only the owner of the private key that generated this public key could have produced this signature on this transaction."</p>
</div>
<div>
<p>The signature verification algorithm takes the message (a hash of the transaction or parts of it), the signer‚Äôs public key and the signature (R and S values), and returns TRUE if the signature is valid for this message and public key.</p>
</div>
</div>
<div>
<h4 id="user-content-sighash_types"><a id="user-content-signature-hash-types-sighash" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#signature-hash-types-sighash"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Signature Hash Types (SIGHASH)</h4>
<div>
<p>Digital signatures are applied to messages, which in the case of bitcoin, are the transactions themselves. The signature implies a <em>commitment</em> by the signer to specific transaction data. In the simplest form, the signature applies to the entire transaction, thereby committing all the inputs, outputs, and other transaction fields. However, a signature can commit to only a subset of the data in a transaction, which is useful for a number of scenarios as we will see in this section.</p>
</div>
<div>
<p>Bitcoin signatures have a way of indicating which part of a transaction‚Äôs data is included in the hash signed by the private key using a SIGHASH flag. The SIGHASH flag is a single byte that is appended to the signature. Every signature has a SIGHASH flag and the flag can be different from input to input. A transaction with three signed inputs may have three signatures with different SIGHASH flags, each signature signing (committing) different parts of the transaction.</p>
</div>
<div>
<p>Remember, each input may contain a signature in its unlocking script. As a result, a transaction that contains several inputs may have signatures with different SIGHASH flags that commit different parts of the transaction in each of the inputs. Note also that bitcoin transactions may contain inputs from different "owners," who may sign only one input in a partially constructed (and invalid) transaction, collaborating with others to gather all the necessary signatures to make a valid transaction. Many of the SIGHASH flag types only make sense if you think of multiple participants collaborating outside the bitcoin network and updating a partially signed transaction.</p>
</div>
<div>
<p>There are three SIGHASH flags: ALL, NONE, and SINGLE, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#sighash_types_and_their">SIGHASH types and their meanings</a>.</p>
</div>

Table 3. SIGHASH types and their meanings





<table id="user-content-sighash_types_and_their"><thead>
<tr>
<th>SIGHASH flag</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>ALL</p></td>
<td><p>0x01</p></td>
<td><p>Signature applies to all inputs and outputs</p></td>
</tr>
<tr>
<td><p>NONE</p></td>
<td><p>0x02</p></td>
<td><p>Signature applies to all inputs, none of the outputs</p></td>
</tr>
<tr>
<td><p>SINGLE</p></td>
<td><p>0x03</p></td>
<td><p>Signature applies to all inputs but only the one output with the same index number as the signed input</p></td>
</tr>
</tbody>
</table>
<div>
<p>In addition, there is a modifier flag SIGHASH_ANYONECANPAY, which can be combined with each of the preceding flags. When ANYONECANPAY is set, only one input is signed, leaving the rest (and their sequence numbers) open for modification. The ANYONECANPAY has the value 0x80 and is applied by bitwise OR, resulting in the combined flags as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#sighash_types_with_modifiers">SIGHASH types with modifiers and their meanings</a>.</p>
</div>

Table 4. SIGHASH types with modifiers and their meanings





<table id="user-content-sighash_types_with_modifiers"><thead>
<tr>
<th>SIGHASH flag</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>ALL|ANYONECANPAY</p></td>
<td><p>0x81</p></td>
<td><p>Signature applies to one input and all outputs</p></td>
</tr>
<tr>
<td><p>NONE|ANYONECANPAY</p></td>
<td><p>0x82</p></td>
<td><p>Signature applies to one input, none of the outputs</p></td>
</tr>
<tr>
<td><p>SINGLE|ANYONECANPAY</p></td>
<td><p>0x83</p></td>
<td><p>Signature applies to one input and the output with the same index number</p></td>
</tr>
</tbody>
</table>
<div>
<p>The way SIGHASH flags are applied during signing and verification is that a copy of the transaction is made and certain fields within are truncated (set to zero length and emptied). The resulting transaction is serialized. The SIGHASH flag is added to the end of the serialized transaction and the result is hashed. The hash itself is the "message" that is signed. Depending on which SIGHASH flag is used, different parts of the transaction are truncated. The resulting hash depends on different subsets of the data in the transaction. By including the SIGHASH as the last step before hashing, the signature commits the SIGHASH type as well, so it can‚Äôt be changed (e.g., by a miner).</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>All SIGHASH types sign the transaction nLocktime field (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#transaction_locktime_nlocktime">[transaction_locktime_nlocktime]</a>). In addition, the SIGHASH type itself is appended to the transaction before it is signed, so that it can‚Äôt be modified once signed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>In the example of Alice‚Äôs transaction (see the list in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#seralization_of_signatures_der">Serialization of signatures (DER)</a>), we saw that the last part of the DER-encoded signature was 01, which is the SIGHASH_ALL flag. This locks the transaction data, so Alice‚Äôs signature is committing the state of all inputs and outputs. This is the most common signature form.</p>
</div>
<div>
<p>Let‚Äôs look at some of the other SIGHASH types and how they can be used in practice:</p>
</div>
<div>
<dl>
<dt>ALL|ANYONECANPAY </dt>
<dd>
<p>This construction can be used to make a "crowdfunding‚Äù-style transaction. Someone attempting to raise funds can construct a transaction with a single output. The single output pays the "goal" amount to the fundraiser. Such a transaction is obviously not valid, as it has no inputs. However, others can now amend it by adding an input of their own, as a donation. They sign their own input with ALL|ANYONECANPAY. Unless enough inputs are gathered to reach the value of the output, the transaction is invalid. Each donation is a "pledge," which cannot be collected by the fundraiser until the entire goal amount is raised.</p>
</dd>
<dt>NONE </dt>
<dd>
<p>This construction can be used to create a "bearer check" or "blank check" of a specific amount. It commits to the input, but allows the output locking script to be changed. Anyone can write their own bitcoin address into the output locking script and redeem the transaction. However, the output value itself is locked by the signature.</p>
</dd>
<dt>NONE|ANYONECANPAY </dt>
<dd>
<p>This construction can be used to build a "dust collector." Users who have tiny UTXO in their wallets can‚Äôt spend these without the cost in fees exceeding the value of the dust. With this type of signature, the dust UTXO can be donated for anyone to aggregate and spend whenever they want.</p>
</dd>
</dl>
</div>
<div>
<p>There are some proposals to modify or expand the SIGHASH system. One such proposal is <em>Bitmask Sighash Modes</em> by Blockstream‚Äôs Glenn Willen, as part of the Elements project. This aims to create a flexible replacement for SIGHASH types that allows "arbitrary, miner-rewritable bitmasks of inputs and outputs" that can express "more complex contractual precommitment schemes, such as signed offers with change in a distributed asset exchange."</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>You will not see SIGHASH flags presented as an option in a user‚Äôs wallet application. With few exceptions, wallets construct P2PKH scripts and sign with SIGHASH_ALL flags. To use a different SIGHASH flag, you would have to write software to construct and sign transactions. More importantly, SIGHASH flags can be used by special-purpose bitcoin applications that enable novel uses.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div>
<h4 id="user-content-ecdsa_math"><a id="user-content-ecdsa-math" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#ecdsa-math"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ECDSA Math</h4>
<div>
<p>As mentioned previously, signatures are created by a mathematical function <em>F</em><sub><em>sig</em></sub> that produces a signature composed of two values <em>R</em> and <em>S</em>. In this section we look at the function <em>F</em><sub><em>sig</em></sub> in more detail.</p>
</div>
<div>
<p>The signature algorithm first generates an <em>ephemeral</em> (temporary) private public key pair. This temporary key pair is used in the calculation of the <em>R</em> and <em>S</em> values, after a transformation involving the signing private key and the transaction hash.</p>
</div>
<div>
<p>The temporary key pair is based on a random number <em>k</em>, which is used as the temporary private key. From <em>k</em>, we generate the corresponding temporary public key <em>P</em> (calculated as <em>P = k*G</em>, in the same way bitcoin public keys are derived; see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#pubkey">[pubkey]</a>). The <em>R</em> value of the digital signature is then the x coordinate of the ephemeral public key <em>P</em>.</p>
</div>
<div>
<p>From there, the algorithm calculates the <em>S</em> value of the signature, such that:</p>
</div>
<div>
<p><em>S</em> = <em>k</em><sup>-1</sup> (<em>Hash</em>(<em>m</em>) + <em>dA</em> * <em>R</em>) <em>mod p</em></p>
</div>
<div>
<p>where:</p>
</div>
<div>
<ul>
<li>
<p><em>k</em> is the ephemeral private key</p>
</li>
<li>
<p><em>R</em> is the x coordinate of the ephemeral public key</p>
</li>
<li>
<p><em>dA</em> is the signing private key</p>
</li>
<li>
<p><em>m</em> is the transaction data</p>
</li>
<li>
<p><em>p</em> is the prime order of the elliptic curve</p>
</li>
</ul>
</div>
<div>
<p>Verification is the inverse of the signature generation function, using the <em>R</em>, <em>S</em> values and the public key to calculate a value <em>P</em>, which is a point on the elliptic curve (the ephemeral public key used in signature creation):</p>
</div>
<div>
<p><em>P</em> = <em>S</em><sup>-1</sup> * <em>Hash</em>(<em>m</em>) * <em>G</em> + <em>S</em><sup>-1</sup> * <em>R</em> * <em>Qa</em></p>
</div>
<div>
<p>where:</p>
</div>
<div>
<ul>
<li>
<p><em>R</em> and <em>S</em> are the signature values</p>
</li>
<li>
<p><em>Qa</em> is Alice‚Äôs public key</p>
</li>
<li>
<p><em>m</em> is the transaction data that was signed</p>
</li>
<li>
<p><em>G</em> is the elliptic curve generator point</p>
</li>
</ul>
</div>
<div>
<p>If the x coordinate of the calculated point <em>P</em> is equal to <em>R</em>, then the verifier can conclude that the signature is valid.</p>
</div>
<div>
<p>Note that in verifying the signature, the private key is neither known nor revealed.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>ECDSA is necessarily a fairly complicated piece of math; a full explanation is beyond the scope of this book. A number of great guides online take you through it step by step: search for "ECDSA explained" or try this one: <a href="http://bit.ly/2r0HhGB" rel="nofollow">http://bit.ly/2r0HhGB</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div>
<h4 id="user-content-the-importance-of-randomness-in-signatures"><a id="user-content-the-importance-of-randomness-in-signatures" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#the-importance-of-randomness-in-signatures"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Importance of Randomness in Signatures</h4>
<div>
<p>As we saw in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#ecdsa_math">ECDSA Math</a>, the signature generation algorithm uses a random key <em>k</em>, as the basis for an ephemeral private/public key pair. The value of <em>k</em> is not important, <em>as long as it is random</em>. If the same value <em>k</em> is used to produce two signatures on different messages (transactions), then the signing <em>private key</em> can be calculated by anyone. Reuse of the same value for <em>k</em> in a signature algorithm leads to exposure of the private key!</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Warning</div>
</td>
<td>
<div>
<p>If the same value <em>k</em> is used in the signing algorithm on two different transactions, the private key can be calculated and exposed to the world!</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>This is not just a theoretical possibility. We have seen this issue lead to exposure of private keys in a few different implementations of transaction-signing algorithms in bitcoin. People have had funds stolen because of inadvertent reuse of a <em>k</em> value. The most common reason for reuse of a <em>k</em> value is an improperly initialized random-number generator.</p>
</div>
<div>
<p>To avoid this vulnerability, the industry best practice is to not generate <em>k</em> with a random-number generator seeded with entropy, but instead to use a deterministic-random process seeded with the transaction data itself. This ensures that each transaction produces a different <em>k</em>. The industry-standard algorithm for deterministic initialization of <em>k</em> is defined in <a href="https://tools.ietf.org/html/rfc6979" rel="nofollow">RFC 6979</a>, published by the Internet Engineering Task Force.</p>
</div>
<div>
<p>If you are implementing an algorithm to sign transactions in bitcoin, you <em>must</em> use RFC 6979 or a similarly deterministic-random algorithm to ensure you generate a different <em>k</em> for each transaction.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-bitcoin-addresses-balances-and-other-abstractions"><a id="user-content-bitcoin-addresses-balances-and-other-abstractions" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#bitcoin-addresses-balances-and-other-abstractions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bitcoin Addresses, Balances, and Other Abstractions</h3>
<div>
<p>We began this chapter with the discovery that transactions look very different "behind the scenes" than how they are presented in wallets, blockchain explorers, and other user-facing applications. Many of the simplistic and familiar concepts from the earlier chapters, such as bitcoin addresses and balances, seem to be absent from the transaction structure. We saw that transactions don‚Äôt contain bitcoin addresses, per se, but instead operate through scripts that lock and unlock discrete values of bitcoin. Balances are not present anywhere in this system and yet every wallet application prominently displays the balance of the user‚Äôs wallet.</p>
</div>
<div>
<p>Now that we have explored what is actually included in a bitcoin transaction, we can examine how the higher-level abstractions are derived from the seemingly primitive components of the transaction.</p>
</div>
<div>
<p>Let‚Äôs look again at how Alice‚Äôs transaction was presented on a popular block explorer (<a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#alice_transaction_to_bobs_cafe">Alice‚Äôs transaction to Bob‚Äôs Cafe</a>).</p>
</div>
<div id="user-content-alice_transaction_to_bobs_cafe">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0208.png"><img src="./Transactions_files/mbc2_0208.png" alt="Alice Coffee Transaction" style="max-width:100%;"></a>
</div>
<div>Figure 7. Alice‚Äôs transaction to Bob‚Äôs Cafe</div>
</div>
<div>
<p>On the left side of the transaction, the blockchain explorer shows Alice‚Äôs bitcoin address as the "sender." In fact, this information is not in the transaction itself. When the blockchain explorer retrieved the transaction it also retrieved the previous transaction referenced in the input and extracted the first output from that older transaction. Within that output is a locking script that locks the UTXO to Alice‚Äôs public key hash (a P2PKH script). The blockchain explorer extracted the public key hash and encoded it using Base58Check encoding to produce and display the bitcoin address that represents that public key.</p>
</div>
<div>
<p>Similarly, on the right side, the blockchain explorer shows the two outputs; the first to Bob‚Äôs bitcoin address and the second to Alice‚Äôs bitcoin address (as change). Once again, to create these bitcoin addresses, the blockchain explorer extracted the locking script from each output, recognized it as a P2PKH script, and extracted the public-key-hash from within. Finally, the blockchain explorer reencoded that public key hash with Base58Check to produce and display the bitcoin addresses.</p>
</div>
<div>
<p>If you were to click on Bob‚Äôs bitcoin address, the blockchain explorer would show you the view in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#the_balance_of_bobs_bitcoin_address">The balance of Bob‚Äôs bitcoin address</a>.</p>
</div>
<div id="user-content-the_balance_of_bobs_bitcoin_address">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_0608.png"><img src="./Transactions_files/mbc2_0608.png" alt="The balance of Bob‚Äôs bitcoin address" style="max-width:100%;"></a>
</div>
<div>Figure 8. The balance of Bob‚Äôs bitcoin address</div>
</div>
<div>
<p>The blockchain explorer displays the balance of Bob‚Äôs bitcoin address. But nowhere in the bitcoin system is there a concept of a "balance." Rather, the values displayed here are constructed by the blockchain explorer as follows.</p>
</div>
<div>
<p>To construct the "Total Received" amount, the blockchain explorer first will decode the Base58Check encoding of the bitcoin address to retrieve the 160-bit hash of Bob‚Äôs public key that is encoded within the address. Then, the blockchain explorer will search through the database of transactions, looking for outputs with P2PKH locking scripts that contain Bob‚Äôs public key hash. By summing up the value of all the outputs, the blockchain explorer can produce the total value received.</p>
</div>
<div>
<p>Constructing the current balance (displayed as "Final Balance") requires a bit more work. The blockchain explorer keeps a separate database of the outputs that are currently unspent, the UTXO set. To maintain this database, the blockchain explorer must monitor the bitcoin network, add newly created UTXO, and remove spent UTXO, in real time, as they appear in unconfirmed transactions. This is a complicated process that depends on keeping track of transactions as they propagate, as well as maintaining consensus with the bitcoin network to ensure that the correct chain is followed. Sometimes, the blockchain explorer goes out of sync and its perspective of the UTXO set is incomplete or incorrect.</p>
</div>
<div>
<p>From the UTXO set, the blockchain explorer sums up the value of all unspent outputs referencing Bob‚Äôs public key hash and produces the "Final Balance" number shown to the user.</p>
</div>
<div>
<p>In order to produce this one image, with these two "balances," the blockchain explorer has to index and search through dozens, hundreds, or even hundreds of thousands of transactions.</p>
</div>
<div>
<p>In summary, the information presented to users through wallet applications, blockchain explorers, and other bitcoin user interfaces is often composed of higher-level abstractions that are derived by searching many different transactions, inspecting their content, and manipulating the data contained within them. By presenting this simplistic view of bitcoin transactions that resemble bank checks from one sender to one recipient, these applications have to abstract a lot of underlying details. They mostly focus on the common types of transactions: P2PKH with SIGHASH_ALL signatures on every input. Thus, while bitcoin applications can present more than 80% of all transactions in an easy-to-read manner, they are sometimes stumped by transactions that deviate from the norm. Transactions that contain more complex locking scripts, or different SIGHASH flags, or many inputs and outputs, demonstrate the simplicity and weakness of these abstractions.</p>
</div>
<div>
<p>Every day, hundreds of transactions that do not contain P2PKH outputs are confirmed on the blockchain. The blockchain explorers often present these with red warning messages saying they cannot decode an address. The following link contains the most recent "strange transactions" that were not fully decoded: <a href="https://blockchain.info/strange-transactions" rel="nofollow">https://blockchain.info/strange-transactions</a>.</p>
</div>
<div>
<p>As we will see in the next chapter, these are not necessarily strange transactions. They are transactions that contain more complex locking scripts than the common P2PKH. We will learn how to decode and understand more complex scripts and the applications they support next.</p>
</div>
</div>
</div>
</div></article>
  </div>

    </div>

  

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line" role="button"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line" role="dialog" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="js-jump-to-line-form Box-body d-flex" action="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="‚úì">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line‚Ä¶" aria-label="Jump to line" autofocus="">
        <button type="submit" class="btn" data-close-dialog="">Go</button>
</form>    </details-dialog>
  </details>



  </div>
</div>

    </main>
  </div>
  

  </div>

        
<div class="footer container-lg width-full p-responsive" role="contentinfo">
  <div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">¬© 2019 <span title="0.48369s from unicorn-769b7b9f69-wh2rf">GitHub</span>, Inc.</li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to security, text:security" href="https://github.com/security">Security</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://githubstatus.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com/">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mx-lg-4" href="https://github.com/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.blog/" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
    </button>
    You can‚Äôt perform that action at this time.
  </div>


    
    <script crossorigin="anonymous" integrity="sha512-2e003yIUkuCG1IeaeQwIgzMwqYiC+7wN/ouvY2yay84wnLng3/MScKxudf02uj4T4RZAnF5zJumvacsF9lfTMw==" type="application/javascript" src="./Transactions_files/frameworks-8e9b232b.js.download"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-5srqGco8avFoVw1A62FcGlaY8DzO3MWwwTL6l+CRizuO765zsFZkXamHphgnKHUzGbOOvr+NrqNS9CXYS1ySlQ==" type="application/javascript" src="./Transactions_files/github-bootstrap-75ce8f90.js.download"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner" hidden="">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc">Reload</a> to refresh your session.</span>
  </div>
  <template id="site-details-dialog"></template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

  <div aria-live="polite" class="js-global-screen-reader-notice sr-only"></div>

  


</body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>